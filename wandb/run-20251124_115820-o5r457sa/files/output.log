step is  0  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
Step 0 Loss: 0.9916300773620605 Final Loss: 0.9191470742225647
step is  1  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  2  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  3  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  4  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  5  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  6  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  7  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  8  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  9  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  10  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  11  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  12  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  13  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  14  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  15  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  16  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  17  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  18  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  19  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  20  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  21  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  22  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  23  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  24  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  25  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  26  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  27  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  28  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  29  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  30  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  31  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  32  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  33  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  34  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  35  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  36  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  37  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  38  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  39  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  40  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  41  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  42  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  43  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  44  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  45  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  46  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  47  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  48  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  49  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  50  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  51  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  52  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  53  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  54  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  55  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  56  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  57  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  58  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  59  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  60  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  61  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  62  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  63  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  64  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  65  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  66  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  67  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  68  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  69  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  70  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  71  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  72  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  73  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  74  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  75  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  76  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  77  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  78  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  79  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  80  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  81  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  82  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  83  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  84  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  85  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  86  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  87  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  88  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  89  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  90  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  91  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  92  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  93  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  94  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  95  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  96  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  97  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  98  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  99  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  100  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
Step 100 Loss: 0.48266416788101196 Final Loss: 0.09852153062820435
step is  101  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  102  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  103  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  104  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  105  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  106  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  107  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
step is  108  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
Traceback (most recent call last):
  File "/accounts/projects/peter/gatmiry/distributional-CoT/train.py", line 51, in <module>
    main()
    ~~~~^^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
    ~~~~~~~~~~^
        args=args,
        ^^^^^^^^^^
    ...<3 lines>...
        config_name=config_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
    ~~~~~~~~^
        run=args.run,
        ^^^^^^^^^^^^^
    ...<5 lines>...
        overrides=overrides,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
    ~~~~~~~~~~~~~~^
        lambda: hydra.run(
        ^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        )
        ^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ~~~~~~~~~^
        config_name=config_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^
        task_function=task_function,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        overrides=overrides,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
        hydra_context=HydraContext(
    ...<6 lines>...
        configure_logging=with_log_configuration,
    )
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ~~~~~~~~~~~~~^^^^^^^^^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/train.py", line 47, in main
    train.fit()
    ~~~~~~~~~^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py", line 84, in fit
    output_vals, loss = model(batch, cot_outputs)
                        ~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/accounts/projects/peter/gatmiry/distributional-CoT/model.py", line 106, in forward
    output_vals = self.linear_head(x[:, input_length - 1:-1]).squeeze(-1)
                  ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
