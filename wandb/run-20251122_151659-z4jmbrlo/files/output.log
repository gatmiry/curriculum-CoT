================================================================================
Using device: cuda
/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py:69: UserWarning: Using a target size (torch.Size([128])) that is different to the input size (torch.Size([126, 48, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  final_loss = F.mse_loss(output_vals[:-2], cot_outputs[:, -1])
Step 0 Loss: 1.8848152160644531 Final Loss: 1.0817822217941284
Step 100 Loss: 0.673333466053009 Final Loss: 1.1074879169464111
Step 200 Loss: 0.12311845272779465 Final Loss: 1.735331654548645
Step 300 Loss: 0.10756322741508484 Final Loss: 1.8486785888671875
Step 400 Loss: 0.0775691568851471 Final Loss: 1.9020735025405884
Step 500 Loss: 0.0671825036406517 Final Loss: 1.9162521362304688
Step 600 Loss: 0.06224396452307701 Final Loss: 1.860445499420166
Step 700 Loss: 0.05354313924908638 Final Loss: 1.8767844438552856
Step 800 Loss: 0.041996393352746964 Final Loss: 2.1927270889282227
Step 900 Loss: 0.011204580776393414 Final Loss: 2.219491481781006
Step 1000 Loss: 0.0033623548224568367 Final Loss: 2.1342499256134033
Step 1100 Loss: 0.0017291646217927337 Final Loss: 2.0643551349639893
Step 1200 Loss: 0.0014084991998970509 Final Loss: 1.9999090433120728
Step 1300 Loss: 0.0010162797989323735 Final Loss: 2.095243453979492
Step 1400 Loss: 0.0008455550414510071 Final Loss: 1.9333711862564087
Step 1500 Loss: 0.0005652303225360811 Final Loss: 2.12738037109375
Step 1600 Loss: 0.0004812591359950602 Final Loss: 2.002126693725586
Step 1700 Loss: 0.0004753257380798459 Final Loss: 2.1417505741119385
Step 1800 Loss: 0.00030473273363895714 Final Loss: 1.9663928747177124
Step 1900 Loss: 0.0002617187856230885 Final Loss: 2.1633212566375732
Step 2000 Loss: 0.000314411852741614 Final Loss: 2.0693676471710205
Step 2100 Loss: 0.0001934242172865197 Final Loss: 1.9199570417404175
Step 2200 Loss: 0.0002164958423236385 Final Loss: 2.098158597946167
Step 2300 Loss: 0.00022603521938435733 Final Loss: 1.9388872385025024
Step 2400 Loss: 0.0001745344343362376 Final Loss: 1.9854419231414795
Step 2500 Loss: 0.00016904000949580222 Final Loss: 1.98838472366333
Step 2600 Loss: 0.00018491757509764284 Final Loss: 1.7860376834869385
Step 2700 Loss: 0.0001291268563363701 Final Loss: 1.8853187561035156
Step 2800 Loss: 0.0001347655343124643 Final Loss: 1.9142910242080688
Step 2900 Loss: 0.00011610695219133049 Final Loss: 2.1677451133728027
Step 3000 Loss: 0.0002979981654789299 Final Loss: 1.9118034839630127
Step 3100 Loss: 0.0004114556359127164 Final Loss: 1.8996729850769043
Step 3200 Loss: 0.00025963730877265334 Final Loss: 1.8984119892120361
Step 3300 Loss: 0.0001950674777617678 Final Loss: 2.017925262451172
Step 3400 Loss: 8.547868492314592e-05 Final Loss: 1.9597247838974
Step 3500 Loss: 0.00017472042236477137 Final Loss: 2.068706750869751
Step 3600 Loss: 6.850277713965625e-05 Final Loss: 1.8404127359390259
Step 3700 Loss: 0.00017246844072360545 Final Loss: 2.0022575855255127
Step 3800 Loss: 6.348905299091712e-05 Final Loss: 1.849698781967163
Step 3900 Loss: 8.37832412798889e-05 Final Loss: 2.008450508117676
Step 4000 Loss: 0.00033623198396526277 Final Loss: 2.082395076751709
Step 4100 Loss: 5.526292443391867e-05 Final Loss: 1.9913208484649658
Step 4200 Loss: 5.783729284303263e-05 Final Loss: 2.124898910522461
Step 4300 Loss: 0.00016236823284998536 Final Loss: 1.979598045349121
Step 4400 Loss: 8.128423360176384e-05 Final Loss: 2.004979372024536
Step 4500 Loss: 0.0014416405465453863 Final Loss: 1.9087762832641602
Step 4600 Loss: 3.831375215668231e-05 Final Loss: 2.070317029953003
Step 4700 Loss: 9.400620183441788e-05 Final Loss: 2.176434278488159
Step 4800 Loss: 3.47464119840879e-05 Final Loss: 1.829133152961731
Step 4900 Loss: 5.228481313679367e-05 Final Loss: 1.970048427581787
Step 5000 Loss: 2.87537641270319e-05 Final Loss: 1.8423810005187988
Step 5100 Loss: 5.344107557903044e-05 Final Loss: 1.987550973892212
Step 5200 Loss: 2.6038067517220043e-05 Final Loss: 2.0207605361938477
Step 5300 Loss: 4.025050293421373e-05 Final Loss: 1.936663269996643
Step 5400 Loss: 4.349048685980961e-05 Final Loss: 2.0830929279327393
Step 5500 Loss: 2.5839768568403088e-05 Final Loss: 1.9027752876281738
Step 5600 Loss: 3.136323357466608e-05 Final Loss: 1.9317984580993652
Step 5700 Loss: 4.7888246626826e-05 Final Loss: 2.1214802265167236
Step 5800 Loss: 4.4514064938994125e-05 Final Loss: 2.006200075149536
Step 5900 Loss: 8.788761624600738e-05 Final Loss: 1.9203548431396484
Step 6000 Loss: 3.517358345561661e-05 Final Loss: 2.0172579288482666
Step 6100 Loss: 0.00017269411182496697 Final Loss: 1.982548713684082
Step 6200 Loss: 3.762661435757764e-05 Final Loss: 1.8436213731765747
Step 6300 Loss: 5.345540921553038e-05 Final Loss: 1.803459644317627
Step 6400 Loss: 3.832003858406097e-05 Final Loss: 2.0037736892700195
Step 6500 Loss: 2.3865302864578553e-05 Final Loss: 1.911577582359314
Step 6600 Loss: 3.624632518040016e-05 Final Loss: 2.088045835494995
Step 6700 Loss: 2.008230694627855e-05 Final Loss: 1.848021149635315
Step 6800 Loss: 3.755974830710329e-05 Final Loss: 2.056732416152954
Step 6900 Loss: 1.868685103545431e-05 Final Loss: 1.8926146030426025
Step 7000 Loss: 3.091668986598961e-05 Final Loss: 1.9621168375015259
Step 7100 Loss: 0.0009056837880052626 Final Loss: 1.9265291690826416
Step 7200 Loss: 0.0002899832325056195 Final Loss: 1.8405684232711792
Step 7300 Loss: 0.0001664577575866133 Final Loss: 1.9907610416412354
Step 7400 Loss: 0.00012697026249952614 Final Loss: 1.7126895189285278
Step 7500 Loss: 8.751398854656145e-05 Final Loss: 2.045196533203125
Step 7600 Loss: 7.71663908381015e-05 Final Loss: 1.8752251863479614
Step 7700 Loss: 6.080351522541605e-05 Final Loss: 2.060678482055664
Step 7800 Loss: 5.261404294287786e-05 Final Loss: 1.9877315759658813
Step 7900 Loss: 4.708618871518411e-05 Final Loss: 2.0302212238311768
Step 8000 Loss: 3.8548503653146327e-05 Final Loss: 1.8857077360153198
Step 8100 Loss: 3.8247428165050223e-05 Final Loss: 1.9034940004348755
Step 8200 Loss: 3.048923463211395e-05 Final Loss: 1.8610645532608032
Step 8300 Loss: 2.6225101464660838e-05 Final Loss: 1.9504116773605347
Step 8400 Loss: 2.4530350856366567e-05 Final Loss: 1.9833673238754272
Step 8500 Loss: 2.2769463612348773e-05 Final Loss: 1.930720567703247
Step 8600 Loss: 2.217190012743231e-05 Final Loss: 2.1443891525268555
Step 8700 Loss: 2.118644624715671e-05 Final Loss: 1.7298544645309448
Step 8800 Loss: 1.8787839508149773e-05 Final Loss: 1.9082876443862915
Step 8900 Loss: 1.779167359927669e-05 Final Loss: 1.846361756324768
Step 9000 Loss: 1.630009319342207e-05 Final Loss: 2.0549116134643555
Step 9100 Loss: 1.5263080058502965e-05 Final Loss: 1.8270137310028076
Step 9200 Loss: 1.4637000276707113e-05 Final Loss: 1.8429639339447021
Step 9300 Loss: 1.4163540981826372e-05 Final Loss: 1.9849072694778442
Step 9400 Loss: 1.3936969480710104e-05 Final Loss: 1.8035629987716675
Step 9500 Loss: 1.2604773473867681e-05 Final Loss: 2.072683095932007
Step 9600 Loss: 1.045383578457404e-05 Final Loss: 1.9321931600570679
Step 9700 Loss: 1.098464781534858e-05 Final Loss: 1.8366130590438843
Step 9800 Loss: 1.002316548692761e-05 Final Loss: 2.0878915786743164
Step 9900 Loss: 1.005078502203105e-05 Final Loss: 2.0785489082336426
