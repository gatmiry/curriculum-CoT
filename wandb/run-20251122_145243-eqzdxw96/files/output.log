================================================================================
Using device: cuda
samples type in get_batch is torch.int64
bacth type before return is torch.float32
batch type is torch.int64
shape of output_vals[:, input_length - 1:-1] torch.Size([128, 36, 1]) shape of cts_tokens torch.Size([128, 36])
/accounts/projects/peter/gatmiry/distributional-CoT/model.py:107: UserWarning: Using a target size (torch.Size([128, 36])) that is different to the input size (torch.Size([128, 36, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  loss = F.mse_loss(output_vals[:, input_length - 1:-1], cts_tokens)
Error executing job with overrides: []
Traceback (most recent call last):
  File "/accounts/projects/peter/gatmiry/distributional-CoT/train.py", line 47, in main
    train.fit()
    ~~~~~~~~~^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py", line 63, in fit
    output_vals, loss = model(batch, cot_outputs)
                        ~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/accounts/projects/peter/gatmiry/distributional-CoT/model.py", line 107, in forward
    loss = F.mse_loss(output_vals[:, input_length - 1:-1], cts_tokens)
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/functional.py", line 3884, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
                                      ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/functional.py", line 76, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
RuntimeError: The size of tensor a (36) must match the size of tensor b (128) at non-singleton dimension 1

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
