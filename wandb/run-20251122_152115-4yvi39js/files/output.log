================================================================================
Using device: cuda
shape of output_vals torch.Size([128, 48]) shape of cot_outputs[:, -1] torch.Size([128, 36])
/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py:70: UserWarning: Using a target size (torch.Size([128])) that is different to the input size (torch.Size([126, 48])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  final_loss = F.mse_loss(output_vals[:-2], cot_outputs[:, -1])
Error executing job with overrides: []
Traceback (most recent call last):
  File "/accounts/projects/peter/gatmiry/distributional-CoT/train.py", line 47, in main
    train.fit()
    ~~~~~~~~~^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py", line 70, in fit
    final_loss = F.mse_loss(output_vals[:-2], cot_outputs[:, -1])
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/nn/functional.py", line 3884, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
                                      ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/usr/local/linux/miniforge-3.13/lib/python3.13/site-packages/torch/functional.py", line 76, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
RuntimeError: The size of tensor a (48) must match the size of tensor b (128) at non-singleton dimension 1

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
