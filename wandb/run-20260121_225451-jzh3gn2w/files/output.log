Training parity function on 20 bits with 20 phases
Device: cuda
Config: n_layers=1, n_heads=1, n_embd=256
Training: batch_size=256, lr=1e-05, max_iterations=15000, target_loss=0.2, multilevel=True

Model parameters: 670,464
Total inputs (sampled for eval): 10000 (training uses fresh random samples)

Using RANDOM SUBSET for parity (same for all phases):
  Parity bits: [3, 4, 6, 9, 10, 11, 12, 13, 17, 18]

============================================================
PHASE 1: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 1 CoT tokens
============================================================
Phase 1:   1%|▌                                     | 200/15000 [00:01<02:22, 103.59it/s, loss=0.0001, eval_loss=inf]

  Sample predictions (phase 1, parity of first 1 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+]-++++-+-+++-++-++--       +1    +0.9993     +1        ✓
  [-]++-+-+++++-+++-----       +1    +1.0203     +1        ✓
  [+]-++-+---+--+-++-+-+       +1    +0.9890     +1        ✓
  [-]-+-+++++++--+---+--       +1    +1.0189     +1        ✓
  [-]-++++------++++--+-       +1    +1.0067     +1        ✓
  [-]-+-++-+-++--+++--++       +1    +1.0043     +1        ✓
  Phase 1, Iter 200: Train Loss = 0.0353, Eval Loss = 0.0001, Accuracy = 100.00%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 1, parity of first 1 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+]--++++++--+-+---+++       +1    +0.9996     +1        ✓
  [+]-----+---+--+-+----       +1    +1.0285     +1        ✓
  [+]+--+-+-+-++-++---++       +1    +0.9977     +1        ✓
  [-]+++++++-+++++++-+-+       +1    +0.9892     +1        ✓
  [+]++-+---++---++---+-       +1    +0.9936     +1        ✓
  [+]---++-+--+-----+--+       +1    +1.0109     +1        ✓
  [+]+---+--+-++-+-+-++-       +1    +0.9955     +1        ✓
  [+]+++-++--++---+-++-+       +1    +0.9831     +1        ✓
Phase 1 Complete: Final Loss = 0.0001, Accuracy = 100.00% (after 199 iterations)

============================================================
PHASE 2: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 2 CoT tokens
============================================================
Phase 2:   1%|▌                                      | 200/15000 [00:02<02:32, 97.16it/s, loss=0.0002, eval_loss=inf]

  Sample predictions (phase 2, parity of first 2 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+]-++++-+-+++-+--++-       +1    +0.9479     +1        ✓
  [+-]--++-+--+-----+--+       +1    +1.0355     +1        ✓
  [++]---+--+--++-++----       +1    +1.0473     +1        ✓
  [+-]--+-+-----+--+--++       +1    +0.8936     +1        ✓
  [-+]-++++-++--++--+-++       +1    +0.9844     +1        ✓
  [++]+++-+++--++-+---+-       +1    +0.9722     +1        ✓
  Phase 2, Iter 200: Train Loss = 0.0634, Eval Loss = 0.0033, Accuracy = 100.00%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 2, parity of first 2 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-]+-++-+-++---+-++++       +1    +0.9615     +1        ✓
  [--]+--++--++-+-----++       +1    +1.0423     +1        ✓
  [-+]+-++---+++--++---+       +1    +0.9872     +1        ✓
  [--]+++------++-++---+       +1    +1.0458     +1        ✓
  [--]---+-+--+-+++--++-       +1    +1.0588     +1        ✓
  [-+]-+-+---+-++-++-+++       +1    +1.0115     +1        ✓
  [++]+-++---+++++++++++       +1    +0.8737     +1        ✓
  [--]-+-+----+++++++---       +1    +1.0500     +1        ✓
Phase 2 Complete: Final Loss = 0.0033, Accuracy = 100.00% (after 199 iterations)

============================================================
PHASE 3: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 3 CoT tokens
============================================================
Phase 3:   1%|▌                                      | 200/15000 [00:02<02:45, 89.62it/s, loss=0.0004, eval_loss=inf]

  Sample predictions (phase 3, parity of first 3 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+-]++--++----++---+-       +1    +1.0117     +1        ✓
  [--+]+-+-++++--+---+++       +1    +0.9752     +1        ✓
  [+-+]++--+++---+-++--+       +1    +0.9914     +1        ✓
  [+-+]-----+--++----+-+       +1    +1.0311     +1        ✓
  [++-]---+-++++-++-++++       +1    +0.9691     +1        ✓
  [+++]---+-++-+++-+--++       +1    +0.9840     +1        ✓
  Phase 3, Iter 200: Train Loss = 0.0030, Eval Loss = 0.0008, Accuracy = 100.00%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 3, parity of first 3 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+]---++++---++--+++       +1    +0.9895     +1        ✓
  [--+]++-+--+--+-++-++-       +1    +1.0055     +1        ✓
  [+++]---++-++++--+---+       +1    +0.9788     +1        ✓
  [---]---++-+-+-+-++-++       +1    +0.9913     +1        ✓
  [-++]+---++++++----+++       +1    +0.9658     +1        ✓
  [-++]-----++----+++-++       +1    +0.9844     +1        ✓
  [+-+]+----++-++-+-+---       +1    +0.9908     +1        ✓
  [-++]+--+----+-----+++       +1    +1.0501     +1        ✓
Phase 3 Complete: Final Loss = 0.0008, Accuracy = 100.00% (after 199 iterations)

============================================================
PHASE 4: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 4 CoT tokens
============================================================
Phase 4:   4%|█▍                                  | 599/15000 [00:11<04:02, 59.35it/s, loss=0.0006, eval_loss=0.5151]

  Sample predictions (phase 4, parity of first 4 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+++]+--------+-+---+       +1    -0.2837     -1        ✗
  [-+-+]-+-+-+--+-+-+-++       +1    -0.0567     -1        ✗
  [---+]+-+---++--++-+++       +1    -0.0124     -1        ✗
  [----]++++---+-+-++-++       -1    -0.0138     -1        ✓
  [++-+]+++-++--+++---+-       +1    +0.4363     +1        ✓
  [++++]-++--++---+-++-+       +1    +0.3121     +1        ✓
  Phase 4, Iter 200: Train Loss = 0.5442, Eval Loss = 0.8819, Accuracy = 64.18%

  Sample predictions (phase 4, parity of first 4 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+]--+-----++--+--+       +1    -0.3896     -1        ✗
  [--+-]++++++---++-+-++       -1    +0.2962     +1        ✗
  [+-+-]+-+++---+-+---+-       -1    +0.0277     +1        ✗
  [+-++]+-+--+-+--+---++       +1    +0.9812     +1        ✓
  [-+--]++-++-----++++-+       -1    -0.3388     -1        ✓
  [++--]++--++--+++---+-       -1    -0.1575     -1        ✓
  Phase 4, Iter 400: Train Loss = 0.3505, Eval Loss = 0.5151, Accuracy = 80.41%

  Sample predictions (phase 4, parity of first 4 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-+]--++-+++--++-+++       +1    -0.4358     -1        ✗
  [++-+]---++++----+-+++       +1    -0.5277     -1        ✗
  [-+-+]-+++--+---+-+---       +1    -0.0831     -1        ✗
  [--++]-++--+-+----++-+       +1    +0.8030     +1        ✓
  [+++-]-++-++------+---       -1    -1.5598     -1        ✓
  [++++]----++-++--+++-+       +1    +0.5236     +1        ✓
  Phase 4, Iter 600: Train Loss = 0.2032, Eval Loss = 0.2861, Accuracy = 89.06%

  Sample predictions (phase 4, parity of first 4 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++-]-+---+-+++++-+--       -1    -1.2746     -1        ✓
  [---+]--+---++--++----       +1    +0.5684     +1        ✓
  [---+]+-+-+------+----       +1    +1.3592     +1        ✓
  [-+-+]+--+-+++++++--++       +1    +1.1539     +1        ✓
  [-+-+]--+---+++-+-+---       +1    +0.5190     +1        ✓
  [++++]++++-++--+++---+       +1    +0.8681     +1        ✓
  Phase 4, Iter 800: Train Loss = 0.0840, Eval Loss = 0.0776, Accuracy = 100.00%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 4, parity of first 4 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+--]-+-+---+----++++       -1    -1.0000     -1        ✓
  [++-+]---+--+++-+-++++       +1    +0.5856     +1        ✓
  [---+]+++-++---++-+-++       +1    +1.4372     +1        ✓
  [-+--]--------+-++++-+       -1    -1.0117     -1        ✓
  [+---]+++--+-+---++++-       -1    -0.9259     -1        ✓
  [+---]-++++-+++-++++--       -1    -1.1105     -1        ✓
  [-+--]+-++--++-+++---+       -1    -0.7699     -1        ✓
  [+-++]++++-+-+--------       +1    +1.1035     +1        ✓
Phase 4 Complete: Final Loss = 0.0776, Accuracy = 100.00% (after 799 iterations)

============================================================
PHASE 5: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 5 CoT tokens
============================================================
Phase 5:   1%|▌                                      | 200/15000 [00:04<05:15, 46.92it/s, loss=0.0292, eval_loss=inf]

  Sample predictions (phase 5, parity of first 5 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++++-]++++-++-++-+++-       -1    -0.9482     -1        ✓
  [--+-+]--+-+-++--++---       -1    -1.0524     -1        ✓
  [-+-++]--++-+++-+-+-+-       +1    +0.7234     +1        ✓
  [+-+--]+-+-++++++-+++-       +1    +0.5850     +1        ✓
  [-+-+-]-+---+-+-----++       -1    -0.9143     -1        ✓
  [+----]+-++-++-++-++--       +1    +0.9244     +1        ✓
  Phase 5, Iter 200: Train Loss = 0.1139, Eval Loss = 0.0280, Accuracy = 100.00%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 5, parity of first 5 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+++-+]-+--+--+++-++-+       -1    -0.9668     -1        ✓
  [+-+-+]++--+++++++-+--       -1    -0.8419     -1        ✓
  [++-++]+--+++--+-++-+-       +1    +0.9711     +1        ✓
  [++---]-++--++-++----+       +1    +1.0547     +1        ✓
  [----+]-+++-+--+-+++++       -1    -0.8865     -1        ✓
  [++-+-]--+-+-+--++-++-       -1    -0.8699     -1        ✓
  [--+-+]---++++--+-++-+       -1    -1.0516     -1        ✓
  [-++-+]--+--+-+-+--+--       -1    -0.9879     -1        ✓
Phase 5 Complete: Final Loss = 0.0280, Accuracy = 100.00% (after 199 iterations)

============================================================
PHASE 6: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 6 CoT tokens
============================================================
Phase 6:   1%|▌                                      | 200/15000 [00:04<05:01, 49.08it/s, loss=0.1128, eval_loss=inf]

  Sample predictions (phase 6, parity of first 6 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+++--+]+++-+++-++-++-       +1    +0.9981     +1        ✓
  [---++-]---++-+---++-+       +1    +0.4647     +1        ✓
  [-+---+]--++-++--+--++       +1    +0.7485     +1        ✓
  [--++--]+--+-----++-+-       -1    -0.9480     -1        ✓
  [+-++++]+---+-+-------       +1    +1.0632     +1        ✓
  [+-+-++]++++-+++++-+-+       -1    -0.3758     -1        ✓
  Phase 6, Iter 200: Train Loss = 0.2706, Eval Loss = 0.1166, Accuracy = 100.00%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 6, parity of first 6 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++-+-]++--++--+---+-       -1    -1.0246     -1        ✓
  [+++++-]+++---+-++--+-       +1    +1.3070     +1        ✓
  [+++-++]----++-++--+-+       -1    -0.9566     -1        ✓
  [---+-+]----+-+-+--+-+       -1    -1.0436     -1        ✓
  [+++-++]+---++-++---++       -1    -0.6847     -1        ✓
  [---+-+]-+-+----+--+-+       -1    -1.0472     -1        ✓
  [++-+--]-++--++-------       -1    -0.5186     -1        ✓
  [-++---]+-++-++--+----       +1    +0.5989     +1        ✓
Phase 6 Complete: Final Loss = 0.1166, Accuracy = 100.00% (after 199 iterations)

============================================================
PHASE 7: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 7 CoT tokens
============================================================
Phase 7:   4%|█▍                                  | 599/15000 [00:13<05:07, 46.76it/s, loss=0.2643, eval_loss=0.3778]

  Sample predictions (phase 7, parity of first 7 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [----++-]++--+-+++----       +1    -0.0531     -1        ✗
  [+-+--+-]+--+++----++-       -1    +0.3195     +1        ✗
  [+-+-++-]+++-+-+++++--       +1    -0.0502     -1        ✗
  [-+-+-++]+++-+--++++-+       -1    -0.5814     -1        ✓
  [+++--++]-+-+-++-+----       +1    +0.2860     +1        ✓
  [-+++-++]++++-++--++--       -1    -0.5156     -1        ✓
  Phase 7, Iter 200: Train Loss = 0.4541, Eval Loss = 0.5232, Accuracy = 81.21%

  Sample predictions (phase 7, parity of first 7 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+-+++]+-+---+-+----       -1    +0.1329     +1        ✗
  [+++-+++]----+-++-++++       -1    +0.5277     +1        ✗
  [+++-+++]-+---++++++-+       -1    +0.5165     +1        ✗
  [-+++--+]++---+-++++--       -1    -0.8627     -1        ✓
  [----+--]++-+--++-----       +1    +0.8276     +1        ✓
  [+++--++]+-----++-++--       +1    +0.4222     +1        ✓
  Phase 7, Iter 400: Train Loss = 0.2907, Eval Loss = 0.3778, Accuracy = 87.79%

  Sample predictions (phase 7, parity of first 7 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+-+++]--++-+++--+++       -1    +0.1233     +1        ✗
  [-+-++--]++++++-+-+++-       -1    +0.3422     +1        ✗
  [+---++-]-+++--+-+----       +1    -0.5739     -1        ✗
  [+--+-++]-++-+++++----       -1    -0.4694     -1        ✓
  [---++--]-++------++++       -1    -0.8676     -1        ✓
  [++-+---]++-+++-------       +1    +0.8803     +1        ✓
  Phase 7, Iter 600: Train Loss = 0.2122, Eval Loss = 0.3189, Accuracy = 90.13%

  Sample predictions (phase 7, parity of first 7 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [----+++]+++-++-+--+++       -1    +0.2423     +1        ✗
  [-+--++-]++--+++++-+++       +1    -0.0623     -1        ✗
  [++--++-]+-+-+--+--++-       +1    -0.1188     -1        ✗
  [-+----+]++++-++++--+-       +1    +1.2612     +1        ✓
  [-++++-+]+------+---+-       +1    +1.0567     +1        ✓
  [+-+++--]-+---++------       -1    -0.9266     -1        ✓
  Phase 7, Iter 800: Train Loss = 0.1652, Eval Loss = 0.2664, Accuracy = 91.69%

  Sample predictions (phase 7, parity of first 7 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++--+-+]-+++++-----++       -1    -1.1497     -1        ✓
  [+--++++]---++-++-----       +1    +0.5397     +1        ✓
  [+-+-+-+]+-+-+---++++-       -1    -0.8979     -1        ✓
  [--+---+]+-+++--+++---       +1    +0.8946     +1        ✓
  [+--+++-]--+---++--+--       -1    -0.6232     -1        ✓
  [++-++--]+++---++-+-++       -1    -0.7040     -1        ✓
  Phase 7, Iter 1000: Train Loss = 0.1477, Eval Loss = 0.1103, Accuracy = 100.00%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 7, parity of first 7 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+++-]-++--+++----+       -1    -0.6655     -1        ✓
  [++++-+-]+----++++--++       +1    +1.1814     +1        ✓
  [+++----]++---+---++--       -1    -1.1474     -1        ✓
  [-+-+-++]-+-+--+++-++-       -1    -0.7834     -1        ✓
  [-+++-+-]-++-+---++--+       +1    +1.2269     +1        ✓
  [++---+-]-+-+-+--+++++       -1    -0.4864     -1        ✓
  [++++-+-]---++-+--+--+       +1    +1.2432     +1        ✓
  [--+++--]---+-+----+--       -1    -0.9750     -1        ✓
Phase 7 Complete: Final Loss = 0.1103, Accuracy = 100.00% (after 999 iterations)

============================================================
PHASE 8: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 8 CoT tokens
============================================================
Phase 8:   4%|█▍                                  | 599/15000 [00:14<05:38, 42.55it/s, loss=0.1281, eval_loss=0.2481]

  Sample predictions (phase 8, parity of first 8 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+++-+++-]--+----+-++-       -1    +0.1009     +1        ✗
  [-+--+--+]++---++---+-       +1    -0.1166     -1        ✗
  [-+--+---]--+++-++++-+       +1    -0.0913     -1        ✗
  [-++---+-]+-+++--++--+       +1    +0.5932     +1        ✓
  [---++++-]-+-+-+--++--       +1    +0.1905     +1        ✓
  [-++-+-++]-+---+++-++-       -1    -0.8111     -1        ✓
  Phase 8, Iter 200: Train Loss = 0.3306, Eval Loss = 0.3875, Accuracy = 90.12%

  Sample predictions (phase 8, parity of first 8 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+-+++-+]+-+++-++-+--       -1    +0.4595     +1        ✗
  [--+-----]-++------+++       -1    +0.1280     +1        ✗
  [++++---+]++++--++-++-       +1    -0.0370     -1        ✗
  [+--+-++-]+--+--+-+-++       -1    -1.2143     -1        ✓
  [+++----+]++++-++-+++-       -1    -1.0246     -1        ✓
  [---++---]-++---+-++++       -1    -0.4884     -1        ✓
  Phase 8, Iter 400: Train Loss = 0.2003, Eval Loss = 0.2481, Accuracy = 95.75%

  Sample predictions (phase 8, parity of first 8 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [----++++]-++---+++-++       -1    +0.1039     +1        ✗
  [+++-++++]+++--+-+---+       -1    +0.0954     +1        ✗
  [++--++++]+-+--+++--+-       -1    +0.0784     +1        ✗
  [-+--+---]----++--+--+       +1    +0.5857     +1        ✓
  [--+-+-++]--+---++-+--       -1    -0.6871     -1        ✓
  [++-++-++]+++--+++++--       +1    +0.6837     +1        ✓
  Phase 8, Iter 600: Train Loss = 0.1399, Eval Loss = 0.1457, Accuracy = 97.71%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 8, parity of first 8 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+++-+++-]-----++-+-++       -1    +0.1500     +1        ✗
  [+++-+++-]+--+--+++-+-       -1    +0.0701     +1        ✗
  [++--+++-]----+--++-+-       -1    +0.0200     +1        ✗
  [++--++++]++---+--+-+-       -1    +0.0771     +1        ✗
  [-++--+++]--+----++-++       +1    +1.0532     +1        ✓
  [-+-+-++-]-++++++-+-+-       -1    -1.0730     -1        ✓
  [+++-++-+]+--++--+-+--       +1    +0.2800     +1        ✓
  [++----+-]++++-++-++++       +1    +0.7740     +1        ✓
Phase 8 Complete: Final Loss = 0.1457, Accuracy = 97.71% (after 599 iterations)

============================================================
PHASE 9: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 9 CoT tokens
============================================================
Phase 9:   4%|█▍                                  | 599/15000 [00:14<05:22, 44.65it/s, loss=0.1550, eval_loss=0.3739]

  Sample predictions (phase 9, parity of first 9 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+--+++-+]+-+-++-+---       -1    +0.1563     +1        ✗
  [--+--++++]+--+++----+       +1    -0.0882     -1        ✗
  [----++++-]+---+++-+--       -1    +0.0575     +1        ✗
  [+--+-+-++]---++--+-++       +1    +0.4536     +1        ✓
  [+-----+--]-+--+-+----       +1    +0.1475     +1        ✓
  [+----+-++]-++--+++---       -1    -0.4597     -1        ✓
  Phase 9, Iter 200: Train Loss = 0.5732, Eval Loss = 0.5365, Accuracy = 83.72%

  Sample predictions (phase 9, parity of first 9 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-++++--]-+-++--+--+       +1    -0.4956     -1        ✗
  [++--++-++]-+++---+++-       +1    -0.1808     -1        ✗
  [-+-++++++]++-++-++++-       +1    -0.1364     -1        ✗
  [+-+++---+]+----+-++-+       -1    -0.6960     -1        ✓
  [---+-+-++]--++--+-+++       +1    +1.2669     +1        ✓
  [-+++-+-++]-++-+-----+       +1    +0.5950     +1        ✓
  Phase 9, Iter 400: Train Loss = 0.2458, Eval Loss = 0.3739, Accuracy = 89.61%

  Sample predictions (phase 9, parity of first 9 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+-++-+-]-+++++++--+       +1    -0.0713     -1        ✗
  [--+-++-++]+-++-++++++       +1    -0.0494     -1        ✗
  [----+++++]+---+---+++       -1    +0.1020     +1        ✗
  [+--+++-++]-++----+--+       -1    -0.8028     -1        ✓
  [--+++--+-]-++----+-++       -1    -0.8434     -1        ✓
  [--++++---]+++++----++       -1    -0.9647     -1        ✓
  Phase 9, Iter 600: Train Loss = 0.1697, Eval Loss = 0.1574, Accuracy = 96.95%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 9, parity of first 9 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-++++--]+--++--+-++       +1    -0.0590     -1        ✗
  [++-+++--+]++-++-++-++       -1    +0.0936     +1        ✗
  [++-+++--+]+-++-++--++       -1    +0.0926     +1        ✗
  [--+-++-+-]++++++++++-       +1    -0.0547     -1        ✗
  [-+---+-+-]--++++-+-++       -1    -1.3921     -1        ✓
  [--++--+--]--+++++++--       -1    -0.9469     -1        ✓
  [-+--+--++]---++-+++-+       +1    +1.0768     +1        ✓
  [++-+-+---]+--------++       +1    +1.0851     +1        ✓
Phase 9 Complete: Final Loss = 0.1574, Accuracy = 96.95% (after 599 iterations)

============================================================
PHASE 10: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 10 CoT tokens
============================================================
Phase 10:   4%|█▍                                 | 599/15000 [00:15<06:10, 38.90it/s, loss=0.0009, eval_loss=0.5675]

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+++-++--]++-+-+++-+       -1    +0.0375     +1        ✗
  [-+--+-+--+]++----+--+       -1    +0.1714     +1        ✗
  [--+-++++-+]---+--+-+-       -1    +0.0479     +1        ✗
  [++------++]+++-++--++       -1    -0.3614     -1        ✓
  [---+--+---]++-+-----+       +1    +0.1398     +1        ✓
  [-+--++-+-+]++----+++-       +1    +0.4385     +1        ✓
  Phase 10, Iter 200: Train Loss = 0.6033, Eval Loss = 0.7626, Accuracy = 74.13%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--++---+-+]--+++-+-++       +1    -0.0719     -1        ✗
  [++++----++]--+++----+       +1    -0.2156     -1        ✗
  [+-+-----+-]---+----+-       +1    -0.1436     -1        ✗
  [-+++-+----]-+-++-+---       -1    -0.5226     -1        ✓
  [--+--+-+++]-+-++++-++       -1    -0.6269     -1        ✓
  [+---+-+---]---++---+-       +1    +0.8703     +1        ✓
  Phase 10, Iter 400: Train Loss = 0.3707, Eval Loss = 0.5675, Accuracy = 82.18%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+-+--+++-]-+++-+++--       +1    -0.3673     -1        ✗
  [++++-+----]++-+--+--+       -1    +0.5466     +1        ✗
  [--+++-+---]-++----+-+       -1    +0.0276     +1        ✗
  [+----+---+]-++-++++++       -1    -0.8871     -1        ✓
  [+-+++-++--]++-+------       -1    -0.8075     -1        ✓
  [-++-----+-]+-++-+-+--       +1    +1.1394     +1        ✓
  Phase 10, Iter 600: Train Loss = 0.2933, Eval Loss = 0.3670, Accuracy = 92.57%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+--++++--+]-+-+++++-+       +1    -0.0052     -1        ✗
  [++--+--+--]+--+---++-       -1    +0.4177     +1        ✗
  [-+++++++--]+++--+-+-+       -1    +0.1955     +1        ✗
  [++-+----++]-++-+-+---       +1    +0.7761     +1        ✓
  [-++-+---++]---+-+--+-       +1    +1.1920     +1        ✓
  [++--++-++-]--++----+-       -1    -0.1775     -1        ✓
  Phase 10, Iter 800: Train Loss = 0.2352, Eval Loss = 0.3214, Accuracy = 92.72%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--++++++--]-++-++--+-       -1    +0.0102     +1        ✗
  [-+-++--+--]++----++-+       +1    -0.0182     -1        ✗
  [-+-+--+++-]+++----+--       +1    -0.0810     -1        ✗
  [-----++--+]-----+-+++       +1    +0.5134     +1        ✓
  [+--++++-+-]++--+-++++       -1    -0.3065     -1        ✓
  [--++--++++]++-----+--       -1    -0.6582     -1        ✓
  Phase 10, Iter 1000: Train Loss = 0.1918, Eval Loss = 0.2670, Accuracy = 95.37%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+--++--+--]-----+++++       +1    -0.0890     -1        ✗
  [+--+-+-+++]-+-+++---+       +1    -0.0774     -1        ✗
  [+--++--+--]--+++---++       +1    -0.0859     -1        ✗
  [-++--+-++-]--+-------       +1    +0.1553     +1        ✓
  [++++++-++-]+++++---++       +1    +1.0702     +1        ✓
  [+-++++-++-]++---+----       +1    +0.7486     +1        ✓
  Phase 10, Iter 1200: Train Loss = 0.1412, Eval Loss = 0.2056, Accuracy = 97.99%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+++++---+-]--+++--+-+       +1    -0.2789     -1        ✗
  [--+-++++++]+--+---+--       -1    +0.0793     +1        ✗
  [-+++++++-+]+----++++-       +1    -0.0719     -1        ✗
  [-++------+]++--++-+-+       -1    -0.9876     -1        ✓
  [+-+-++-+++]-+-+++++--       +1    +0.6858     +1        ✓
  [------++-+]++---+-+-+       +1    +1.4950     +1        ✓
  Phase 10, Iter 1400: Train Loss = 0.1392, Eval Loss = 0.2904, Accuracy = 92.93%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+---++-+++]-+--+--+++       +1    -0.4437     -1        ✗
  [--+-++++--]-+--+++---       +1    -0.2521     -1        ✗
  [+---++++--]-++-+--+++       +1    -0.0713     -1        ✗
  [+++-++-+-+]-+--++---+       +1    +0.7109     +1        ✓
  [-++++-+--+]++++------       +1    +1.6436     +1        ✓
  [++++-+-+++]--+-++---+       +1    +1.1826     +1        ✓
  Phase 10, Iter 1600: Train Loss = 0.1399, Eval Loss = 0.3070, Accuracy = 93.28%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+----+++-]----+---+-       -1    +0.4032     +1        ✗
  [---+++++--]--+-+-+++-       -1    +0.1389     +1        ✗
  [+-+-+++--+]+-++---++-       -1    +0.4487     +1        ✗
  [++-++--++-]+++-+--+++       +1    +0.0511     +1        ✓
  [--++++-++-]---+-+-+--       +1    +0.5762     +1        ✓
  [-+--+---++]+--+++-+++       +1    +0.8326     +1        ✓
  Phase 10, Iter 1800: Train Loss = 0.1438, Eval Loss = 0.3491, Accuracy = 92.16%

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+-++++--]++-+-+----       +1    -0.0535     -1        ✗
  [+-+-+++--+]--+-+--+-+       -1    +0.1255     +1        ✗
  [+-+-+++--+]+-++-+----       -1    +0.0960     +1        ✗
  [-++++-+++-]+--+--+-++       -1    -0.9815     -1        ✓
  [--+--+---+]-++-+--+--       -1    -0.6946     -1        ✓
  [--+-+----+]++++-++++-       +1    +1.0483     +1        ✓
  Phase 10, Iter 2000: Train Loss = 0.1055, Eval Loss = 0.0963, Accuracy = 99.85%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 10, parity of first 10 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+-+++--+]++++++-+--       -1    +0.0957     +1        ✗
  [+-+-+++--+]++++--++-+       -1    +0.1025     +1        ✗
  [+-+-+++--+]+-++-+----       -1    +0.0960     +1        ✗
  [+-+-+++--+]--+-+--+-+       -1    +0.1255     +1        ✗
  [--+--++-++]+++-------       +1    +0.6381     +1        ✓
  [++++---+++]+----+++--       +1    +0.8191     +1        ✓
  [-+-+-+-+--]--++--+++-       -1    -0.9994     -1        ✓
  [+--+++----]-++-++-+++       +1    +1.0000     +1        ✓
Phase 10 Complete: Final Loss = 0.0963, Accuracy = 99.85% (after 1999 iterations)

============================================================
PHASE 11: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 11 CoT tokens
============================================================
Phase 11:   4%|█▍                                 | 599/15000 [00:14<03:53, 61.62it/s, loss=0.5592, eval_loss=0.6848]

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+---++-++]+++----++       +1    -0.1468     -1        ✗
  [+++-++-+-++]--++---+-       +1    -0.2117     -1        ✗
  [----+--+--+]--++---+-       -1    +0.1791     +1        ✗
  [---+---+-++]-+--++--+       +1    +0.0090     +1        ✓
  [++--+-++-+-]-++--+--+       +1    +0.0239     +1        ✓
  [++-+--+---+]++++--+--       +1    +0.4330     +1        ✓
  Phase 11, Iter 200: Train Loss = 0.5875, Eval Loss = 0.8824, Accuracy = 65.52%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+++++-+--]+------+-       +1    -0.1933     -1        ✗
  [+-+++++--+-]++++-++--       -1    +0.1141     +1        ✗
  [+++-++-++--]++-++++++       +1    -0.1545     -1        ✗
  [----++--+++]----++-+-       +1    +0.4126     +1        ✓
  [--+-+-++-+-]--++++++-       +1    +0.0923     +1        ✓
  [-++---++-+-]+-+++-+++       -1    -0.1540     -1        ✓
  Phase 11, Iter 400: Train Loss = 0.4804, Eval Loss = 0.6848, Accuracy = 77.14%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+-++-++-+]+-++-+-+-       -1    +0.0030     +1        ✗
  [+-+++---++-]+----+-++       +1    -0.4109     -1        ✗
  [---+-+----+]++++++-+-       -1    +0.0846     +1        ✗
  [++--+-++--+]++-+++---       +1    +0.0553     +1        ✓
  [--++++-----]-++++--+-       -1    -0.3735     -1        ✓
  [-++------+-]+-+-+----       +1    +0.3169     +1        ✓
  Phase 11, Iter 600: Train Loss = 0.3734, Eval Loss = 0.5671, Accuracy = 81.48%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+-+-+---]--+++-+-+       +1    -0.1270     -1        ✗
  [+-+--++-+++]+-+------       +1    -0.5954     -1        ✗
  [---+-------]---+----+       +1    -0.2666     -1        ✗
  [++-++-+--++]+---+++-+       +1    +0.7027     +1        ✓
  [+--+-+-+-++]-++++-++-       +1    +0.3814     +1        ✓
  [++---++-+-+]--++-++--       -1    -0.8706     -1        ✓
  Phase 11, Iter 800: Train Loss = 0.3693, Eval Loss = 0.4514, Accuracy = 85.76%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++++-+--++]++--+-+++       +1    -0.2841     -1        ✗
  [+-++--++--+]+++-+-+--       +1    -0.0289     -1        ✗
  [++-+----++-]++++-++--       -1    +0.3201     +1        ✗
  [+++-+++--+-]++------+       +1    +0.4917     +1        ✓
  [+-+---+++++]---+----+       +1    +0.7464     +1        ✓
  [-++---+--+-]++-+-+-+-       -1    -0.9527     -1        ✓
  Phase 11, Iter 1000: Train Loss = 0.3032, Eval Loss = 0.3883, Accuracy = 89.39%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-+-+---++]+++--++++       +1    -0.0437     -1        ✗
  [+-++++-++-+]+++++-+++       +1    -0.6172     -1        ✗
  [++-+-+---++]--+--+--+       +1    -0.0045     -1        ✗
  [-+-+++-++-+]+--++-+++       +1    +0.1903     +1        ✓
  [+---++-+-+-]-+----+++       -1    -0.7571     -1        ✓
  [+-++++-+-++]+-+-++-++       -1    -0.1289     -1        ✓
  Phase 11, Iter 1200: Train Loss = 0.2686, Eval Loss = 0.3485, Accuracy = 91.01%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++---+-+++-]+++--++-+       +1    -0.5294     -1        ✗
  [+--+-+---+-]++--+-+-+       -1    +0.1644     +1        ✗
  [---++--+-++]-+-++-+--       -1    +0.3076     +1        ✗
  [++--+--+++-]++++-+--+       -1    -0.6357     -1        ✓
  [--+++--+-+-]++-+-+---       +1    +1.4891     +1        ✓
  [-+-+---+---]+-+-+--+-       +1    +0.9693     +1        ✓
  Phase 11, Iter 1400: Train Loss = 0.2435, Eval Loss = 0.6802, Accuracy = 76.70%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++--+-+-+++]--++--+++       -1    +0.0428     +1        ✗
  [++++-++--++]+-----+--       -1    +0.0518     +1        ✗
  [++--+-+--++]-+++-+-++       -1    +0.3776     +1        ✗
  [-+-+-++--++]+-+--+-+-       -1    -0.0808     -1        ✓
  [----+-++++-]---+-+-++       +1    +0.9963     +1        ✓
  [--------+++]-+----+-+       -1    -0.4246     -1        ✓
  Phase 11, Iter 1600: Train Loss = 0.2300, Eval Loss = 0.3492, Accuracy = 90.31%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---++++--+-]++-+++---       -1    +0.0978     +1        ✗
  [+-++++-++++]-----+++-       -1    +0.3096     +1        ✗
  [+-+++---+++]---++-+++       -1    +0.2033     +1        ✗
  [+-+++-+--++]-+----+++       +1    +0.4518     +1        ✓
  [+++++-+--++]-------+-       +1    +0.8341     +1        ✓
  [----+-+-+--]-+--+----       -1    -1.0721     -1        ✓
  Phase 11, Iter 1800: Train Loss = 0.2129, Eval Loss = 0.2277, Accuracy = 95.32%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+-++----+]-+----+--       -1    +0.1744     +1        ✗
  [++++++-+--+]++--+++--       +1    -0.0996     -1        ✗
  [--+-++-++-+]--++-++--       -1    +0.0103     +1        ✗
  [--+--++++++]+---+++++       +1    +0.5632     +1        ✓
  [--+------+-]-+-+--+-+       +1    +0.3680     +1        ✓
  [+--+--+---+]+--+-+---       +1    +0.5472     +1        ✓
  Phase 11, Iter 2000: Train Loss = 0.2126, Eval Loss = 0.2156, Accuracy = 96.15%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-++++--++]-+---+--+       +1    -0.2311     -1        ✗
  [+++-+-+++--]-+-+++++-       -1    +0.1134     +1        ✗
  [++-+++-----]+---+-+--       -1    +0.0142     +1        ✗
  [+++------+-]+--+-++-+       +1    +0.5852     +1        ✓
  [+-+++--++--]-+--+++-+       -1    -0.8294     -1        ✓
  [---+---++-+]++++---+-       -1    -1.1962     -1        ✓
  Phase 11, Iter 2200: Train Loss = 0.1754, Eval Loss = 0.2591, Accuracy = 94.31%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+++------]+++--+++-       -1    +0.7439     +1        ✗
  [+-+++---++-]---+-++-+       +1    -0.1130     -1        ✗
  [-+-+-++--++]+-+++----       -1    +0.0257     +1        ✗
  [-+-+---+++-]+--+----+       -1    -0.6455     -1        ✓
  [--+--+-+-++]++-+--+--       -1    -0.6079     -1        ✓
  [++-+--+++--]++--+-+--       -1    -1.1765     -1        ✓
  Phase 11, Iter 2400: Train Loss = 0.2203, Eval Loss = 0.2961, Accuracy = 91.84%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++++---+--+]++++--++-       -1    +0.0972     +1        ✗
  [+-+++---+++]+--+--+--       -1    +0.0183     +1        ✗
  [+-++++---+-]------+++       +1    -0.0683     -1        ✗
  [---+-+-+-++]-++++-+--       +1    +1.1725     +1        ✓
  [+-+-++-+---]---+--+++       +1    +1.2791     +1        ✓
  [-++--++-+--]++---+-++       +1    +1.0201     +1        ✓
  Phase 11, Iter 2600: Train Loss = 0.1600, Eval Loss = 0.2300, Accuracy = 95.36%

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-++++---++]+-+--+-++       -1    +0.1547     +1        ✗
  [+-++++-+++-]+-++--+-+       +1    -0.3378     -1        ✗
  [+-+++-+---+]+---++-++       -1    +0.2872     +1        ✗
  [++---+-+---]++++-+-++       -1    -0.8855     -1        ✓
  [++++--++++-]+-+++---+       +1    +0.8609     +1        ✓
  [++++--+--++]-----+-+-       -1    -1.0976     -1        ✓
  Phase 11, Iter 2800: Train Loss = 0.1843, Eval Loss = 0.1938, Accuracy = 96.94%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 11, parity of first 11 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+-++---++]-++-+---+       +1    -0.0632     -1        ✗
  [--+-++-+--+]-+--+--+-       -1    +0.0609     +1        ✗
  [--+-++-++-+]+--++-+--       -1    +0.0776     +1        ✗
  [+-+-+++++++]-----++--       -1    +0.0901     +1        ✗
  [--+---++---]-+--+--+-       +1    +0.5739     +1        ✓
  [+----+++-++]-+-+-+-++       +1    +0.4513     +1        ✓
  [-++---+-+-+]+---+++-+       -1    -0.9699     -1        ✓
  [++----+++-+]-+++--+-+       -1    -0.7421     -1        ✓
Phase 11 Complete: Final Loss = 0.1938, Accuracy = 96.94% (after 2799 iterations)

============================================================
PHASE 12: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 12 CoT tokens
============================================================
Phase 12:   4%|█▍                                 | 599/15000 [00:10<03:50, 62.49it/s, loss=0.4157, eval_loss=0.6254]

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++-+++----+]+++-+---       -1    +0.0364     +1        ✗
  [+-+---+-++-+]+-+----+       -1    +0.2248     +1        ✗
  [+--+--+++-++]+--+-+++       +1    -0.0035     -1        ✗
  [+++-+++++-+-]--+-+---       -1    -0.9032     -1        ✓
  [++---+--+---]-----+++       +1    +0.3715     +1        ✓
  [--+---+--++-]+++-+-+-       -1    -0.3074     -1        ✓
  Phase 12, Iter 200: Train Loss = 0.6956, Eval Loss = 0.8161, Accuracy = 69.84%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++++-+-++++-]-+++-++-       -1    +0.2628     +1        ✗
  [+++---++-+++]--+--+++       +1    -0.0152     -1        ✗
  [--+-+++---++]-+++-++-       +1    -0.0120     -1        ✗
  [+++-+-++-+-+]-+-+++--       +1    +0.0837     +1        ✓
  [++----++++++]+--++-++       +1    +0.1994     +1        ✓
  [-+++++-+-+--]++-+--++       -1    -0.6217     -1        ✓
  Phase 12, Iter 400: Train Loss = 0.4387, Eval Loss = 0.6254, Accuracy = 78.74%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--++-++--++-]--++-++-       +1    -0.8378     -1        ✗
  [++---+--+--+]+---+-++       -1    +0.3875     +1        ✗
  [++-+-+---+++]++--++++       +1    -0.0392     -1        ✗
  [+++++-------]+-+++-++       +1    +0.3619     +1        ✓
  [--++--++-+--]++-+---+       -1    -0.4745     -1        ✓
  [+++--+-+---+]-----++-       -1    -0.2554     -1        ✓
  Phase 12, Iter 600: Train Loss = 0.3262, Eval Loss = 0.4453, Accuracy = 86.53%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-++----+-+-]-++++++-       +1    -0.4169     -1        ✗
  [-+-++-++---+]+-++----       +1    -0.0349     -1        ✗
  [+--++-++-+--]++-++--+       +1    -0.5844     -1        ✗
  [----+++-+-+-]+-+++---       -1    -1.0974     -1        ✓
  [-++-+---++++]-++--+-+       +1    +0.3985     +1        ✓
  [--+++-+-+-++]--++-+-+       -1    -0.6799     -1        ✓
  Phase 12, Iter 800: Train Loss = 0.2503, Eval Loss = 0.3533, Accuracy = 90.06%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++++---++--+]---+--+-       +1    -0.1385     -1        ✗
  [----+-+---++]+-----++       +1    -0.2030     -1        ✗
  [--++----++--]++++---+       +1    -0.7911     -1        ✗
  [------+--+--]--++---+       +1    +0.8159     +1        ✓
  [+++----+-++-]+++---++       +1    +0.6883     +1        ✓
  [-++-++--++++]+---+-+-       +1    +1.2673     +1        ✓
  Phase 12, Iter 1000: Train Loss = 0.2278, Eval Loss = 0.2874, Accuracy = 93.78%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+++-+---+]--++++--       -1    +0.3476     +1        ✗
  [-----+-+-+-+]+++--+--       +1    -0.4399     -1        ✗
  [++---+--++++]---++++-       -1    +0.3744     +1        ✗
  [---++-++-+++]++--+-+-       +1    +0.1940     +1        ✓
  [++--+-----+-]+-+++-++       +1    +1.4999     +1        ✓
  [-+++--+--++-]-++---+-       +1    +1.1393     +1        ✓
  Phase 12, Iter 1200: Train Loss = 0.2040, Eval Loss = 0.2640, Accuracy = 94.86%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---++---+---]-+-+-+++       +1    -0.6245     -1        ✗
  [++---+---+--]-+----++       -1    +0.7245     +1        ✗
  [++---+---+-+]+---++++       +1    -0.3514     -1        ✗
  [+++-+--+----]-+++++-+       -1    -0.6063     -1        ✓
  [-++-+++----+]++-++-++       -1    -0.1968     -1        ✓
  [+----++-++++]----+---       +1    +0.7275     +1        ✓
  Phase 12, Iter 1400: Train Loss = 0.1770, Eval Loss = 0.2300, Accuracy = 95.62%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+--+-++-+]-+-+----       +1    -0.0050     -1        ✗
  [+----+---++-]+--+----       +1    -0.0020     -1        ✗
  [-----+--+-+-]++++-+-+       -1    +0.0541     +1        ✗
  [-+++--+----+]-----+++       -1    -0.3994     -1        ✓
  [--++-+-+-+--]-+-++--+       +1    +0.9209     +1        ✓
  [--+----+-+-+]-++----+       +1    +1.4912     +1        ✓
  Phase 12, Iter 1600: Train Loss = 0.1839, Eval Loss = 0.2464, Accuracy = 94.83%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+-++-+-+++]-+--+---       +1    -0.2060     -1        ✗
  [--++----++--]+-+++--+       +1    -0.5673     -1        ✗
  [-+---+--++-+]--+++-++       +1    -0.0491     -1        ✗
  [++++-+-+--+-]+++--+++       +1    +0.3406     +1        ✓
  [+----+++-++-]+-+-+-++       -1    -0.7606     -1        ✓
  [++--+++-----]+--++-+-       +1    +1.0817     +1        ✓
  Phase 12, Iter 1800: Train Loss = 0.1780, Eval Loss = 0.2740, Accuracy = 94.32%

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++---+-+-+-+]++-++-++       +1    -0.1052     -1        ✗
  [++---++++-++]+--+---+       -1    +0.2826     +1        ✗
  [------+-++--]---++--+       +1    -0.1142     -1        ✗
  [-+--+++-+-++]-+-++-+-       +1    +1.1616     +1        ✓
  [---++++-----]++---+--       -1    -1.3823     -1        ✓
  [+------++--+]+-------       -1    -0.8400     -1        ✓
  Phase 12, Iter 2000: Train Loss = 0.1630, Eval Loss = 0.1941, Accuracy = 96.86%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 12, parity of first 12 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++++----++-+]-++---++       -1    +0.3256     +1        ✗
  [++---+------]++++--++       +1    -0.4701     -1        ✗
  [--++----++-+]+++-----       -1    +0.3381     +1        ✗
  [++---+-+--+-]+++---+-       -1    +0.8546     +1        ✗
  [+-+--+-+++-+]-----+++       +1    +1.1961     +1        ✓
  [++++-++-++-+]-++++-++       +1    +1.4399     +1        ✓
  [+++--+--+++-]+-+++---       +1    +1.1331     +1        ✓
  [+-+++-+-+-+-]-+--+--+       +1    +0.9595     +1        ✓
Phase 12 Complete: Final Loss = 0.1941, Accuracy = 96.86% (after 1999 iterations)

============================================================
PHASE 13: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 13 CoT tokens
============================================================
Phase 13:   4%|█▍                                 | 599/15000 [00:11<04:42, 50.92it/s, loss=0.4367, eval_loss=0.5687]

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+---++-+++-+]--+++++       -1    +0.0030     +1        ✗
  [-++-+---+-++-]--+++--       +1    -0.5068     -1        ✗
  [---+-+-+++--+]+--+---       +1    -0.1846     -1        ✗
  [-+-+-+--+----]---+++-       +1    +0.3889     +1        ✓
  [-+-++--+-++--]--++-+-       -1    -0.2622     -1        ✓
  [++-----+-----]--+++++       -1    -0.4726     -1        ✓
  Phase 13, Iter 200: Train Loss = 0.4838, Eval Loss = 0.6476, Accuracy = 78.08%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-----+++++-+-]+-+++-+       +1    -0.0862     -1        ✗
  [---+++-++-++-]++-++-+       -1    +0.2873     +1        ✗
  [-+----++-++-+]+--++++       -1    +0.1883     +1        ✗
  [--++--++-+-++]+-+---+       +1    +1.3234     +1        ✓
  [-++++-+-+---+]++--+-+       -1    -0.3875     -1        ✓
  [------++-+---]-++----       -1    -0.2001     -1        ✓
  Phase 13, Iter 400: Train Loss = 0.3638, Eval Loss = 0.5687, Accuracy = 81.00%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+--+-+-+--]++--++-       +1    -0.5578     -1        ✗
  [++---+---+++-]+++++--       +1    -0.2169     -1        ✗
  [+----+-++-++-]-+++---       -1    +0.0410     +1        ✗
  [-++++-+++++--]-+--+--       +1    +0.4915     +1        ✓
  [+-+-+-----+-+]--+-+--       +1    +0.4522     +1        ✓
  [-++--+-----+-]+++-++-       +1    +0.1515     +1        ✓
  Phase 13, Iter 600: Train Loss = 0.2958, Eval Loss = 0.4519, Accuracy = 86.34%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+--+-+--++--+]--+--++       +1    -0.1543     -1        ✗
  [--++++---++-+]+-++--+       +1    -0.0107     -1        ✗
  [-+---+-++--+-]-+-----       +1    -0.8484     -1        ✗
  [+-+++---+-+-+]-----+-       -1    -1.3706     -1        ✓
  [+-+++-+++-+-+]-++++++       +1    +0.7846     +1        ✓
  [+++-++++++++-]+-++---       +1    +0.1760     +1        ✓
  Phase 13, Iter 800: Train Loss = 0.2960, Eval Loss = 0.4808, Accuracy = 84.74%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+---++-++++]+----++       +1    -0.0845     -1        ✗
  [------++--+--]+++-++-       -1    +0.1956     +1        ✗
  [+-+++-+--++++]------+       +1    -0.2835     -1        ✗
  [+++-+++---+--]--+-++-       +1    +0.2265     +1        ✓
  [---+++--++---]+++-+--       +1    +0.8890     +1        ✓
  [----++-++++++]-+--++-       +1    +0.4124     +1        ✓
  Phase 13, Iter 1000: Train Loss = 0.2953, Eval Loss = 0.4045, Accuracy = 88.40%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+---------+]--++---       +1    -0.1107     -1        ✗
  [+++--+---++++]--++-+-       -1    +0.2871     +1        ✗
  [-+++----++-++]+++---+       -1    +0.5528     +1        ✗
  [+-+++-+-+-+++]----+--       -1    -0.8697     -1        ✓
  [-+++--+-+--+-]+-----+       +1    +0.1732     +1        ✓
  [-+--+-++---+-]-+++++-       +1    +0.6958     +1        ✓
  Phase 13, Iter 1200: Train Loss = 0.2675, Eval Loss = 0.3805, Accuracy = 89.25%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-----+++-+--+]-+++-+-       +1    -0.0671     -1        ✗
  [--+--+--+++-+]+-+--+-       +1    -0.2390     -1        ✗
  [----+----++-+]--++-++       -1    +0.1222     +1        ✗
  [+++++-+-+++--]++-+--+       +1    +1.1184     +1        ✓
  [-++--++-+++++]+--+-++       +1    +1.1691     +1        ✓
  [--+---++++--+]-++-+-+       +1    +1.0448     +1        ✓
  Phase 13, Iter 1400: Train Loss = 0.2843, Eval Loss = 0.3808, Accuracy = 89.16%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-----++--+---]+--+++-       -1    +0.0339     +1        ✗
  [-++---+++----]-----++       +1    -0.6060     -1        ✗
  [-+--++-+-----]--+-+++       +1    -0.0565     -1        ✗
  [-+-+--+--++--]+-+--+-       -1    -0.7127     -1        ✓
  [++-----------]--+-++-       -1    -1.0316     -1        ✓
  [++++++-++----]-----+-       -1    -0.7310     -1        ✓
  Phase 13, Iter 1600: Train Loss = 0.2687, Eval Loss = 0.3859, Accuracy = 88.72%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+--+--+--++-]++-++++       +1    -0.5894     -1        ✗
  [-+-+-+----+-+]--+++-+       +1    -0.5404     -1        ✗
  [----+-+-+++++]-++-+--       -1    +0.0646     +1        ✗
  [-+++-+--++--+]-++-+--       +1    +0.7229     +1        ✓
  [++---+--+++-+]+-----+       +1    +0.3759     +1        ✓
  [-++--++++-+--]++----+       -1    -0.0786     -1        ✓
  Phase 13, Iter 1800: Train Loss = 0.2767, Eval Loss = 0.3522, Accuracy = 90.07%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+--++--++-+-+]-------       -1    +0.3780     +1        ✗
  [++-++++++---+]---+++-       -1    +0.6195     +1        ✗
  [+--++---++--+]-+++++-       -1    +0.3481     +1        ✗
  [+---+-++++---]++--+-+       +1    +0.9995     +1        ✓
  [+-+--------+-]+--++--       +1    +1.0822     +1        ✓
  [-++--+-++---+]-------       +1    +0.9666     +1        ✓
  Phase 13, Iter 2000: Train Loss = 0.2357, Eval Loss = 0.3081, Accuracy = 92.00%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-+++++-+-++]+-++-+-       -1    +0.3295     +1        ✗
  [-+-+-+----+-+]++----+       +1    -0.7427     -1        ✗
  [------------+]+---++-       +1    -0.7094     -1        ✗
  [---++----+++-]----+++       +1    +0.7144     +1        ✓
  [+--++++-+-+--]-++++--       -1    -0.0064     -1        ✓
  [+--+--++-+---]++++++-       +1    +1.1821     +1        ✓
  Phase 13, Iter 2200: Train Loss = 0.2012, Eval Loss = 0.3021, Accuracy = 92.08%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+++--+---++++]--++-+-       -1    +0.6591     +1        ✗
  [++--+++-+----]-+-++--       -1    +0.4048     +1        ✗
  [+----+----+++]-++---+       +1    -0.0996     -1        ✗
  [--+-+-++-++++]+++-++-       -1    -1.2894     -1        ✓
  [+--++++++++--]----+++       +1    +0.4184     +1        ✓
  [++-+++-++++-+]--+++++       +1    +1.0444     +1        ✓
  Phase 13, Iter 2400: Train Loss = 0.2205, Eval Loss = 0.3124, Accuracy = 91.72%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+--++--+----+]+++----       +1    -0.1964     -1        ✗
  [+--+--+--++--]-+-++++       -1    +0.0885     +1        ✗
  [+--++++---+--]+---++-       -1    +0.7521     +1        ✗
  [+-+-+--+---++]--++-+-       +1    +1.2237     +1        ✓
  [-++++-+++++--]-+--+--       +1    +0.4196     +1        ✓
  [++++++++-+--+]-+-++--       +1    +1.1394     +1        ✓
  Phase 13, Iter 2600: Train Loss = 0.1895, Eval Loss = 0.2541, Accuracy = 94.84%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+-----+----]++++-++       -1    +0.3022     +1        ✗
  [-----+--++---]++-+--+       +1    -0.3314     -1        ✗
  [---+++++--+++]-++--+-       -1    +0.0015     +1        ✗
  [-+------+-+--]--+-+++       +1    +0.2806     +1        ✓
  [++-+-+-+-+-++]-+++--+       -1    -1.0303     -1        ✓
  [+--++-++++--+]---+-+-       +1    +0.9756     +1        ✓
  Phase 13, Iter 2800: Train Loss = 0.2342, Eval Loss = 0.2834, Accuracy = 93.36%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-+--+-++-++]++--+-+       +1    -0.3548     -1        ✗
  [++-++++--++--]+-+-+-+       +1    -0.1934     -1        ✗
  [-----+++-+-+-]-++-+--       +1    -0.1599     -1        ✗
  [-++-+--+-++--]+++----       +1    +0.8380     +1        ✓
  [++-----++---+]++---+-       +1    +0.5405     +1        ✓
  [+--++++-+-+++]+-++---       -1    -0.4505     -1        ✓
  Phase 13, Iter 3000: Train Loss = 0.1944, Eval Loss = 0.2903, Accuracy = 92.76%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-------++-+++]-+++--+       +1    -0.3682     -1        ✗
  [++-++++---+-+]+--+--+       +1    -0.2110     -1        ✗
  [-+-+-++++-++-]-+-----       -1    +0.2950     +1        ✗
  [-+--+++-+-+++]---++-+       +1    +0.6236     +1        ✓
  [----++--++-+-]++-+---       +1    +0.7590     +1        ✓
  [+-++----++-++]+++-++-       -1    -1.4348     -1        ✓
  Phase 13, Iter 3200: Train Loss = 0.1959, Eval Loss = 0.2926, Accuracy = 92.73%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-----+++-+-+-]-+-+---       +1    -0.2211     -1        ✗
  [--+++++-+--+-]-----+-       -1    +0.0826     +1        ✗
  [-----++++----]---+-++       +1    -0.1143     -1        ✗
  [++----------+]+---++-       +1    +0.8601     +1        ✓
  [--++++++-++-+]---+---       -1    -0.4459     -1        ✓
  [-++--++++--++]---+-+-       +1    +0.3287     +1        ✓
  Phase 13, Iter 3400: Train Loss = 0.1919, Eval Loss = 0.3029, Accuracy = 92.02%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++-+--+-+--+]---+-++       +1    -0.5129     -1        ✗
  [+-+-+-+-++-++]++++--+       +1    -0.4081     -1        ✗
  [---++--+-++++]----+--       -1    +0.0706     +1        ✗
  [------+----+-]-----++       -1    -0.7573     -1        ✓
  [--++-++---++-]-++---+       -1    -1.1903     -1        ✓
  [++---++-++-++]---+-+-       -1    -1.5622     -1        ✓
  Phase 13, Iter 3600: Train Loss = 0.1954, Eval Loss = 0.3157, Accuracy = 91.52%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+-+-+-++++-+]++++--+       -1    +0.1464     +1        ✗
  [++-++++---++-]+++--++       +1    -0.3340     -1        ✗
  [---+++--+--++]----+--       -1    +0.0060     +1        ✗
  [+---------+-+]--++++-       -1    -0.6840     -1        ✓
  [--++-++-++--+]++--+++       -1    -0.4200     -1        ✓
  [-+-+++++----+]-++-+--       -1    -1.0929     -1        ✓
  Phase 13, Iter 3800: Train Loss = 0.1931, Eval Loss = 0.3034, Accuracy = 92.18%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++------+++++]-++--++       -1    +0.0486     +1        ✗
  [+----++++---+]+---+++       -1    +0.2208     +1        ✗
  [++-+++---+---]+++-++-       +1    -0.1263     -1        ✗
  [+++++++++--+-]+--+-+-       -1    -0.1763     -1        ✓
  [--+-+--+-++++]+--++--       +1    +0.9669     +1        ✓
  [-++++--+-++-+]++-+---       +1    +0.1705     +1        ✓
  Phase 13, Iter 4000: Train Loss = 0.2168, Eval Loss = 0.3122, Accuracy = 91.86%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++-++-+++---]+-++--+       -1    +0.2771     +1        ✗
  [+--+--+--++--]------+       -1    +0.4540     +1        ✗
  [--+++++++-+-+]+-++++-       +1    -0.1100     -1        ✗
  [++-++-----++-]-+----+       -1    -1.4431     -1        ✓
  [-+--+-+---+--]+++++++       +1    +0.6380     +1        ✓
  [++----++-+---]-++-++-       -1    -0.8870     -1        ✓
  Phase 13, Iter 4200: Train Loss = 0.2166, Eval Loss = 0.2149, Accuracy = 96.52%

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+-++--++++]-++++++       -1    +0.9705     +1        ✗
  [---+++-+-+-+-]-+-+++-       -1    +0.1768     +1        ✗
  [-++-+---+-++-]--+++--       +1    -0.0604     -1        ✗
  [+----++-+-+-+]++-+--+       +1    +1.1833     +1        ✓
  [++----+-++++-]---+-+-       -1    -1.1587     -1        ✓
  [+++-+++-+--+-]-+++-+-       +1    +0.6093     +1        ✓
  Phase 13, Iter 4400: Train Loss = 0.1400, Eval Loss = 0.1982, Accuracy = 97.26%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 13, parity of first 13 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+-++--+-++--]+++-+-+       -1    +0.0417     +1        ✗
  [-++++++-+-++-]---+--+       +1    -0.2219     -1        ✗
  [-++-+---+-++-]--+++--       +1    -0.0604     -1        ✗
  [-+-++--+-+-+-]+-+---+       -1    +0.2285     +1        ✗
  [---++++--+--+]+----++       +1    +0.2778     +1        ✓
  [+-+---+-++++-]++--+-+       -1    -0.5288     -1        ✓
  [+-++----+--+-]+-+-++-       -1    -1.3297     -1        ✓
  [++---++-+++-+]+++-+--       -1    -1.1565     -1        ✓
Phase 13 Complete: Final Loss = 0.1982, Accuracy = 97.26% (after 4399 iterations)

============================================================
PHASE 14: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 14 CoT tokens
============================================================
Phase 14:   4%|█▍                                 | 599/15000 [00:12<04:42, 50.94it/s, loss=0.0161, eval_loss=0.4169]

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++----+---++++]-+--+-       -1    +0.0632     +1        ✗
  [-++++++++-+-+-]+--+--       -1    +0.0998     +1        ✗
  [----+-+--+--+-]-+-++-       +1    -0.0521     -1        ✗
  [++-----+-++--+]+++--+       -1    -0.1248     -1        ✓
  [++++--+++-+-++]---++-       -1    -0.4971     -1        ✓
  [+++-++++-+++++]-++---       -1    -0.2646     -1        ✓
  Phase 14, Iter 200: Train Loss = 0.5084, Eval Loss = 0.6162, Accuracy = 80.01%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++--++-+++--+]++---+       +1    -0.4959     -1        ✗
  [++-++-+-+--++-]+++---       -1    +0.2019     +1        ✗
  [+-+----+--++++]++++++       +1    -1.0472     -1        ✗
  [-++++-+---++--]+--+-+       -1    -0.2945     -1        ✓
  [++--+-+-+++++-]----++       +1    +1.1091     +1        ✓
  [++--+-+-------]+-+-++       +1    +0.1203     +1        ✓
  Phase 14, Iter 400: Train Loss = 0.3201, Eval Loss = 0.4169, Accuracy = 88.99%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+---+---+--+]-+---+       -1    +0.1388     +1        ✗
  [+---+++++--+++]++++--       -1    +0.0464     +1        ✗
  [-----+----++++]++++-+       +1    -0.0426     -1        ✗
  [++-++-++--+-+-]----+-       -1    -0.3379     -1        ✓
  [----++------+-]-++++-       +1    +0.4421     +1        ✓
  [+++++-+++-+++-]+--+++       +1    +0.1709     +1        ✓
  Phase 14, Iter 600: Train Loss = 0.3217, Eval Loss = 0.3909, Accuracy = 89.59%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++--++-+-++--]-+--+-       -1    +0.1595     +1        ✗
  [+++--++--++++-]-+-++-       -1    +0.3285     +1        ✗
  [++++-+-++-+--+]++-+--       -1    +0.1283     +1        ✗
  [---+---+-+----]-----+       +1    +0.1857     +1        ✓
  [+-++--+-++++++]-+--++       -1    -0.3193     -1        ✓
  [+-+-++--++++--]+-+-++       +1    +0.6080     +1        ✓
  Phase 14, Iter 800: Train Loss = 0.2621, Eval Loss = 0.3541, Accuracy = 90.66%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+--+-+++--++-]+---++       +1    -0.1714     -1        ✗
  [+--+-++-++---+]+-+-++       +1    -0.0001     -1        ✗
  [++-+-+--+++-+-]-++++-       +1    -0.3044     -1        ✗
  [-+--++-++-+---]++-+--       +1    +0.7252     +1        ✓
  [-+---+--++----]-+++++       -1    -0.3191     -1        ✓
  [+---+++++++---]+--+++       +1    +0.5668     +1        ✓
  Phase 14, Iter 1000: Train Loss = 0.2431, Eval Loss = 0.2620, Accuracy = 94.88%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+-++-+-++--+-]-+-+-+       -1    +0.2328     +1        ✗
  [-+-++-++++----]--+++-       +1    -0.2185     -1        ✗
  [-++---++--+--+]-+++++       -1    +0.7877     +1        ✗
  [-+++-+++++--+-]+++++-       +1    +0.4632     +1        ✓
  [--++-++++-++++]-+-++-       +1    +1.0280     +1        ✓
  [--+----+++-+++]+++--+       +1    +1.2181     +1        ✓
  Phase 14, Iter 1200: Train Loss = 0.1802, Eval Loss = 0.2088, Accuracy = 97.07%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-++++----++-]-+++++       -1    +0.4313     +1        ✗
  [--+++---+---++]+---++       +1    -0.1139     -1        ✗
  [--++---++--++-]-+--++       -1    +0.0346     +1        ✗
  [++--+++-----++]++++-+       +1    +0.6189     +1        ✓
  [+--++-+-------]--+-++       -1    -0.1600     -1        ✓
  [++++++++---++-]---+++       -1    -0.2241     -1        ✓
  Phase 14, Iter 1400: Train Loss = 0.2596, Eval Loss = 0.2578, Accuracy = 95.19%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-----+-+-+-+]----+-       -1    +0.0113     +1        ✗
  [++-++++++---+-]--+++-       +1    -0.1692     -1        ✗
  [++-------+----]------       -1    +0.4269     +1        ✗
  [-++----+---++-]-+--+-       +1    +0.8020     +1        ✓
  [+----+++-+--+-]++++++       -1    -0.5608     -1        ✓
  [+++-++++---+-+]+--+-+       +1    +1.4510     +1        ✓
  Phase 14, Iter 1600: Train Loss = 0.1495, Eval Loss = 0.2502, Accuracy = 95.42%

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [------++++++++]+-+--+       +1    -0.1023     -1        ✗
  [-+----------+-]+--+++       -1    +0.0777     +1        ✗
  [+--++--++-+--+]++-++-       +1    -0.3027     -1        ✗
  [+-++-++--++--+]-++---       -1    -1.1888     -1        ✓
  [-+-----+-++++-]+-++--       +1    +0.7106     +1        ✓
  [++---++++----+]++++-+       +1    +0.7163     +1        ✓
  Phase 14, Iter 1800: Train Loss = 0.2050, Eval Loss = 0.1925, Accuracy = 97.29%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 14, parity of first 14 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++---+--++---]+-----       -1    +0.3790     +1        ✗
  [-+----++-++-+-]+--++-       +1    -0.2194     -1        ✗
  [-----+----+---]---+--       -1    +0.0312     +1        ✗
  [+---+++++-+++-]---+++       -1    +0.1084     +1        ✗
  [++--++-++-----]+-++--       -1    -0.6402     -1        ✓
  [++-+++++--++--]+--++-       -1    -0.4688     -1        ✓
  [--+-++----++-+]+++-+-       +1    +0.4510     +1        ✓
  [+-+-+--++--+-+]+--+--       -1    -1.6413     -1        ✓
Phase 14 Complete: Final Loss = 0.1925, Accuracy = 97.29% (after 1799 iterations)

============================================================
PHASE 15: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 15 CoT tokens
============================================================
Phase 15:   4%|█▍                                 | 599/15000 [00:13<05:10, 46.32it/s, loss=0.1773, eval_loss=0.5088]

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+--+---+-++---]+---+       -1    +0.1621     +1        ✗
  [-+--+-+-++-++--]----+       -1    +0.0692     +1        ✗
  [--+++++-----++-]+----       -1    +0.3689     +1        ✗
  [++++++++-++--++]+---+       +1    +0.8299     +1        ✓
  [--++-+---+--+-+]--+--       -1    -0.1382     -1        ✓
  [+--++-+--++++++]---+-       +1    +0.4360     +1        ✓
  Phase 15, Iter 200: Train Loss = 0.6785, Eval Loss = 0.7470, Accuracy = 73.43%

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [---+----+-+-+-+]-+-++       -1    +0.1661     +1        ✗
  [++--+-+++-++--+]--+++       +1    -0.8379     -1        ✗
  [++++--++---+-+-]-+---       +1    -0.4066     -1        ✗
  [+++-+-++++++-+-]+--+-       +1    +0.8711     +1        ✓
  [-+-----+-----+-]++-++       -1    -0.5517     -1        ✓
  [+------+++---+-]---++       +1    +0.6960     +1        ✓
  Phase 15, Iter 400: Train Loss = 0.4036, Eval Loss = 0.5088, Accuracy = 84.28%

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+++-+-++----+]-+++-       +1    -0.0571     -1        ✗
  [++++-+--++-+-+-]+----       +1    -0.2084     -1        ✗
  [+++-+--++-+---+]+-+-+       +1    -0.0079     -1        ✗
  [-+-++--+++++---]-+--+       -1    -1.0317     -1        ✓
  [+++-+---++---++]---+-       -1    -0.6218     -1        ✓
  [-+-+-++-++-+--+]--+--       +1    +0.3997     +1        ✓
  Phase 15, Iter 600: Train Loss = 0.3217, Eval Loss = 0.3956, Accuracy = 89.31%

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+++--+++---+-+]+++--       -1    +0.0021     +1        ✗
  [++--+++++++-+++]+--+-       +1    -0.0145     -1        ✗
  [-+--+++-++-++--]++---       -1    +0.3425     +1        ✗
  [++++-++++---+-+]-+-+-       -1    -1.6521     -1        ✓
  [---+-+--+++-+++]+-+--       -1    -0.7869     -1        ✓
  [--+++++-++++++-]---+-       +1    +0.7667     +1        ✓
  Phase 15, Iter 800: Train Loss = 0.2344, Eval Loss = 0.3335, Accuracy = 91.37%

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+-++----+-+++]-++--       +1    -0.2790     -1        ✗
  [-+--+-----+---+]+--+-       +1    -0.1644     -1        ✗
  [-++-------++-+-]--+-+       -1    +0.4979     +1        ✗
  [-----+-++-+-++-]-+++-       -1    -0.6572     -1        ✓
  [-+++-+++-----+-]-+++-       -1    -1.0454     -1        ✓
  [++-------+-++-+]+++++       -1    -0.8177     -1        ✓
  Phase 15, Iter 1000: Train Loss = 0.2015, Eval Loss = 0.2455, Accuracy = 95.57%

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--++----++++++-]+-++-       +1    -0.0045     -1        ✗
  [+++---++--+++-+]+-+-+       +1    -0.6529     -1        ✗
  [--++--+-++--++-]-++--       -1    +0.0311     +1        ✗
  [+++-+-+--+++--+]-+--+       -1    -0.7962     -1        ✓
  [+++++--+-+++--+]+++++       -1    -1.4349     -1        ✓
  [+-+----+-+----+]-+---       -1    -0.5933     -1        ✓
  Phase 15, Iter 1200: Train Loss = 0.1794, Eval Loss = 0.2317, Accuracy = 95.85%

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+++--++-+-+--+-]---+-       -1    +0.1302     +1        ✗
  [-+----++----+++]+--++       -1    +0.1582     +1        ✗
  [-+-++++++--+---]-+--+       +1    -0.0276     -1        ✗
  [++-++-+++++-++-]++++-       -1    -0.6502     -1        ✓
  [+--+--+-++--+-+]++---       +1    +0.7765     +1        ✓
  [+-+--+++++-++-+]++---       +1    +0.8670     +1        ✓
  Phase 15, Iter 1400: Train Loss = 0.1446, Eval Loss = 0.1972, Accuracy = 97.65%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 15, parity of first 15 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++-+----++++++]+-++-       +1    -0.0711     -1        ✗
  [++---+----+++-+]++-++       -1    +0.1512     +1        ✗
  [--++---+-++-+-+]-+-++       +1    -0.3053     -1        ✗
  [-+--+-+-+-+-+++]--+-+       -1    +0.2061     +1        ✗
  [++--+--+++-+---]---+-       -1    -1.1773     -1        ✓
  [-++++++++-----+]+-++-       -1    -0.4654     -1        ✓
  [+---+-+-+-+-++-]+++-+       -1    -1.0739     -1        ✓
  [---++---++-----]-+---       -1    -0.9642     -1        ✓
Phase 15 Complete: Final Loss = 0.1972, Accuracy = 97.65% (after 1399 iterations)

============================================================
PHASE 16: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 16 CoT tokens
============================================================
Phase 16:   4%|█▍                                 | 599/15000 [00:13<04:56, 48.53it/s, loss=0.4722, eval_loss=0.4460]

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+----++-+----+]-+-+       -1    +0.0162     +1        ✗
  [+++++------+++-+]+-++       -1    +0.8293     +1        ✗
  [++----+++--++---]--+-       -1    +0.0193     +1        ✗
  [---+++--+++-++-+]++-+       +1    +1.0517     +1        ✓
  [-+-+---+++----+-]++++       +1    +0.7443     +1        ✓
  [-++--++--+--++--]+--+       +1    +1.2066     +1        ✓
  Phase 16, Iter 200: Train Loss = 0.4750, Eval Loss = 0.6689, Accuracy = 76.95%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++---+-+---+---]---+       +1    -0.2185     -1        ✗
  [+-+-++-++-+-+--+]-+--       -1    +0.6472     +1        ✗
  [+-++---++----++-]-+-+       +1    -0.3802     -1        ✗
  [-+++----+++---++]+---       -1    -0.9966     -1        ✓
  [++--++----+++++-]+-+-       -1    -0.0472     -1        ✓
  [-++------+-+-++-]+-+-       -1    -0.5099     -1        ✓
  Phase 16, Iter 400: Train Loss = 0.3391, Eval Loss = 0.4460, Accuracy = 86.17%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+++++-----+---]----       +1    -0.8126     -1        ✗
  [-----+-+-+--+-++]++-+       +1    -0.7362     -1        ✗
  [++-+++-+-+-+++-+]++++       +1    -0.0977     -1        ✗
  [-----+--+-+---+-]--+-       -1    -0.5590     -1        ✓
  [-++-+++-----+-+-]++-+       -1    -1.1035     -1        ✓
  [--+--++-+++--+--]----       +1    +0.6858     +1        ✓
  Phase 16, Iter 600: Train Loss = 0.2403, Eval Loss = 0.4479, Accuracy = 86.42%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+--+++------+++-]-+++       +1    -0.2900     -1        ✗
  [+-+++++-+-----+-]+--+       -1    +0.7323     +1        ✗
  [-+-++++--+--+--+]+---       -1    +0.5962     +1        ✗
  [-+-++---++------]-+++       -1    -0.4402     -1        ✓
  [+-++++-------+-+]+++-       -1    -0.1380     -1        ✓
  [++++---++--+-++-]----       -1    -0.5404     -1        ✓
  Phase 16, Iter 800: Train Loss = 0.2417, Eval Loss = 0.3137, Accuracy = 92.60%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++++-++-+++--+-]+---       +1    -0.2712     -1        ✗
  [+-----+++++-++-+]----       -1    +0.2992     +1        ✗
  [+-+-+------++-++]--++       -1    +0.3920     +1        ✗
  [--++----++---+++]+-++       -1    -0.7954     -1        ✓
  [++-+------+----+]--+-       +1    +0.7924     +1        ✓
  [----+-+-++----++]---+       -1    -0.2663     -1        ✓
  Phase 16, Iter 1000: Train Loss = 0.2707, Eval Loss = 0.2531, Accuracy = 95.13%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--++--+-+---++++]+-++       +1    -0.2484     -1        ✗
  [+--++-+++--+--+-]-+-+       +1    -0.1016     -1        ✗
  [-+----++-----+++]----       +1    -0.3359     -1        ✗
  [+-+++-+-+--+++-+]++-+       +1    +0.9916     +1        ✓
  [++--+++-+------+]++++       +1    +1.0037     +1        ✓
  [+--++--+-+++-+--]++++       +1    +0.5847     +1        ✓
  Phase 16, Iter 1200: Train Loss = 0.1930, Eval Loss = 0.2158, Accuracy = 96.32%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+++++-+---++-+]+--+       -1    +0.5222     +1        ✗
  [-++++++--++++-+-]+-+-       -1    +0.3624     +1        ✗
  [--+-++----+-+++-]++--       +1    -0.4992     -1        ✗
  [-+---+++-+--++--]---+       +1    +0.1648     +1        ✓
  [+++++++-++-++---]+++-       +1    +0.5706     +1        ✓
  [-----++++--++-+-]++--       -1    -0.1852     -1        ✓
  Phase 16, Iter 1400: Train Loss = 0.1985, Eval Loss = 0.3394, Accuracy = 91.28%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-++--++-+-+++--+]--+-       +1    -0.1483     -1        ✗
  [+--+---+----++-+]-+++       -1    +0.0184     +1        ✗
  [--+---++-++-++-+]---+       -1    +0.3558     +1        ✗
  [--++-++--+-+----]++-+       +1    +0.3853     +1        ✓
  [++----+++-+-+++-]-+-+       +1    +0.3266     +1        ✓
  [+++----+--+++-+-]-++-       -1    -0.9821     -1        ✓
  Phase 16, Iter 1600: Train Loss = 0.1791, Eval Loss = 0.2101, Accuracy = 96.99%

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [++-------+-++-++]++++       -1    +0.0897     +1        ✗
  [-+--+-++++-+--+-]-+--       +1    -0.2965     -1        ✗
  [+--++++--++++++-]+-+-       +1    -0.1345     -1        ✗
  [+-+-++-++-+-++-+]+---       +1    +0.9775     +1        ✓
  [-++++-+-+--+--+-]-+-+       +1    +1.1892     +1        ✓
  [---+++---+++--++]--+-       -1    -1.4459     -1        ✓
  Phase 16, Iter 1800: Train Loss = 0.1445, Eval Loss = 0.1746, Accuracy = 98.24%
  ✓ Target loss 0.2 reached!

  Sample predictions (phase 16, parity of first 16 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [+-+++++----++-++]+--+       -1    +0.0924     +1        ✗
  [-+++--+-++-+---+]-+++       +1    -0.0914     -1        ✗
  [------++-+++--+-]++--       +1    -0.3373     -1        ✗
  [+++--++++-+-----]----       +1    -0.0522     -1        ✗
  [++-+-+--+++-+--+]+++-       +1    +0.5348     +1        ✓
  [+-+----+--+-+---]-++-       +1    +0.5945     +1        ✓
  [+++--++-+++-+-++]+++-       +1    +0.7941     +1        ✓
  [++-+--+---+++-+-]++++       -1    -0.7050     -1        ✓
Phase 16 Complete: Final Loss = 0.1746, Accuracy = 98.24% (after 1799 iterations)

============================================================
PHASE 17: Learning parity of bits [3, 4, 6, 9, 10, 11, 12, 13, 17, 18] with 17 CoT tokens
============================================================
Phase 17:   4%|█▍                                 | 599/15000 [00:14<04:50, 49.61it/s, loss=0.4051, eval_loss=0.4024]

  Sample predictions (phase 17, parity of first 17 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [--+---++-++-++-+-]--+       -1    +0.1155     +1        ✗
  [+-+-+--++---++---]-+-       -1    +0.4333     +1        ✗
  [+++-+---+++-++-++]---       -1    +0.0418     +1        ✗
  [-+--+--++++----+-]--+       -1    -0.3944     -1        ✓
  [--+++-+++-+---+-+]-++       +1    +0.2681     +1        ✓
  [+++--++++--+-----]---       +1    +0.4377     +1        ✓
  Phase 17, Iter 200: Train Loss = 0.5329, Eval Loss = 0.5856, Accuracy = 80.24%

  Sample predictions (phase 17, parity of first 17 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [-+-++++--+-+-+-++]-+-       +1    -0.6209     -1        ✗
  [++++-+-++-+-++--+]-+-       +1    -0.0302     -1        ✗
  [+--++--+++----+++]++-       -1    +0.1251     +1        ✗
  [--++----+-++--++-]-++       -1    -1.2678     -1        ✓
  [-+-+++--++-----+-]+--       -1    -0.5019     -1        ✓
  [-+--+++---+--++--]+++       +1    +0.6865     +1        ✓
  Phase 17, Iter 400: Train Loss = 0.3092, Eval Loss = 0.4024, Accuracy = 88.24%

  Sample predictions (phase 17, parity of first 17 bits):
  Input                  Target     Output   Pred  Correct
  ------------------------------------------------------
  [------+++++--++--]-++       +1    -0.1055     -1        ✗
  [++++---+++++-+--+]-+-       -1    +0.4840     +1        ✗
  [+--++++--+-+++++-]-++       -1    +0.0220     +1        ✗
  [-+-+++--++---+---]---       +1    +0.5991     +1        ✓
  [+-+-+---------+-+]+--       -1    -0.5087     -1        ✓
  [-----+++++++-+---]---       -1    -0.5829     -1        ✓
  Phase 17, Iter 600: Train Loss = 0.2305, Eval Loss = 0.3456, Accuracy = 91.63%
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/train_parity.py", line 623, in <module>
    main()
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/train_parity.py", line 545, in main
    loss, accuracy, iterations, global_step = train_phase(
                                              ^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/train_parity.py", line 184, in train_phase
    output, loss = model.generate(batch, num_cot_tokens=current_num_cot, target=target)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/model.py", line 269, in generate
    hidden_states = self.forward_with_hidden(idx, final_cot)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/model.py", line 196, in forward_with_hidden
    x = block(x)
        ^^^^^^^^
  File "/accounts/projects/sewonm/prasann/.conda/envs/cotenv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/.conda/envs/cotenv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/model.py", line 123, in forward
    x = x + self.c_attn(self.ln_1(x), last_k_no_attend=0, window_size=0)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/.conda/envs/cotenv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/.conda/envs/cotenv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/model.py", line 92, in forward
    k = apply_rotary_emb(k, self.rope_cos, self.rope_sin)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/sewonm/prasann/projects/curriculum-CoT/unsupervised/model.py", line 48, in apply_rotary_emb
    rotated = torch.cat([
              ^^^^^^^^^^^
KeyboardInterrupt
