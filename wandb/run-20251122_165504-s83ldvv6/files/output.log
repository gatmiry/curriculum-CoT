================================================================================
Using device: cuda
Step 0 Loss: 1.9622169733047485 Final Loss: 0.9993958473205566
Step 100 Loss: 1.0066667795181274 Final Loss: 0.006004200782626867
Step 200 Loss: 0.6840314269065857 Final Loss: 0.011668783612549305
Step 300 Loss: 0.5014652609825134 Final Loss: 0.02862752601504326
Step 400 Loss: 0.30446845293045044 Final Loss: 0.0073613012209534645
Step 500 Loss: 0.2854534089565277 Final Loss: 0.004308105446398258
Step 600 Loss: 0.25459036231040955 Final Loss: 0.004089427646249533
Step 700 Loss: 0.23211246728897095 Final Loss: 0.002773761283606291
Step 800 Loss: 0.22373199462890625 Final Loss: 0.0035967298317700624
Step 900 Loss: 0.21106396615505219 Final Loss: 0.002097718184813857
Step 1000 Loss: 0.19445982575416565 Final Loss: 0.001956390682607889
Step 1100 Loss: 0.17447134852409363 Final Loss: 0.0013646413572132587
Step 1200 Loss: 0.16294148564338684 Final Loss: 0.00362843694165349
Step 1300 Loss: 0.1478797346353531 Final Loss: 0.0013139753136783838
Step 1400 Loss: 0.044737860560417175 Final Loss: 0.001008717343211174
Step 1500 Loss: 0.034895215183496475 Final Loss: 0.0009159243782050908
Step 1600 Loss: 0.02192799001932144 Final Loss: 0.0008915241924114525
Step 1700 Loss: 0.009199895896017551 Final Loss: 0.0007683041039854288
Step 1800 Loss: 0.002868838142603636 Final Loss: 0.0008303410140797496
Step 1900 Loss: 0.0017007089918479323 Final Loss: 0.0005241731414571404
Step 2000 Loss: 0.0010070221032947302 Final Loss: 0.0005033068591728806
Step 2100 Loss: 0.0008449231390841305 Final Loss: 0.0004467526450753212
Step 2200 Loss: 0.0007001224439591169 Final Loss: 0.0003697546781040728
Step 2300 Loss: 0.0005904867430217564 Final Loss: 0.0003132857964374125
Step 2400 Loss: 0.0005465168505907059 Final Loss: 0.0002974582021124661
Step 2500 Loss: 0.0004954017349518836 Final Loss: 0.0002492756466381252
Step 2600 Loss: 0.00042524264426901937 Final Loss: 0.0002080986596411094
Step 2700 Loss: 0.00036214941064827144 Final Loss: 0.00032721774186939
Step 2800 Loss: 0.0003549383254721761 Final Loss: 0.00022356164117809385
Step 2900 Loss: 0.0003003973688464612 Final Loss: 0.00021085247863084078
Step 3000 Loss: 0.0002746238897088915 Final Loss: 0.00018401442503090948
Step 3100 Loss: 0.0002462296688463539 Final Loss: 0.00016137483180500567
Step 3200 Loss: 0.00024343308177776635 Final Loss: 0.0002121247525792569
Step 3300 Loss: 0.00020609100465662777 Final Loss: 0.0001547502470202744
Step 3400 Loss: 0.00019347318448126316 Final Loss: 0.00013100031355861574
Step 3500 Loss: 0.04074180871248245 Final Loss: 0.007580779027193785
Step 3600 Loss: 0.003313658060505986 Final Loss: 0.0013545199763029814
Step 3700 Loss: 0.0016297890106216073 Final Loss: 0.0008007903816178441
Step 3800 Loss: 0.0010777863208204508 Final Loss: 0.000616357778199017
Step 3900 Loss: 0.0008643213077448308 Final Loss: 0.0005738511681556702
Step 4000 Loss: 0.0006850505596958101 Final Loss: 0.0003572888090275228
Step 4100 Loss: 0.0006106860237196088 Final Loss: 0.00040748235187493265
Step 4200 Loss: 0.0005399596993811429 Final Loss: 0.00034622906241565943
Step 4300 Loss: 0.0004519345238804817 Final Loss: 0.0003222797822672874
Step 4400 Loss: 0.0004273678350728005 Final Loss: 0.0002967137552332133
Step 4500 Loss: 0.0003645327815320343 Final Loss: 0.0002831875754054636
Step 4600 Loss: 0.00031740698614157736 Final Loss: 0.00025772940716706216
Step 4700 Loss: 0.0003047006030101329 Final Loss: 0.0002564867027103901
Step 4800 Loss: 0.0002739330811891705 Final Loss: 0.00018850949709303677
Step 4900 Loss: 0.00025236926740035415 Final Loss: 0.00019821789464913309
Step 5000 Loss: 0.00022927398094907403 Final Loss: 0.0001939021603902802
Step 5100 Loss: 0.0002219324669567868 Final Loss: 0.00018471363000571728
Step 5200 Loss: 0.00020144339941907674 Final Loss: 0.00014409428695216775
Step 5300 Loss: 0.0001884179364424199 Final Loss: 0.00017095881048589945
Step 5400 Loss: 0.00017943412240128964 Final Loss: 0.00017416519403923303
Step 5500 Loss: 0.00016367767238989472 Final Loss: 0.00013872931594960392
Step 5600 Loss: 0.00014723646745551378 Final Loss: 0.00015411002095788717
Step 5700 Loss: 0.00014325320080388337 Final Loss: 0.00017471439787186682
Step 5800 Loss: 0.0001446390087949112 Final Loss: 0.00012354488717392087
Step 5900 Loss: 0.00013848811795469373 Final Loss: 0.00012507794599514455
Step 6000 Loss: 0.00011836880003102124 Final Loss: 0.00012149707617936656
Step 6100 Loss: 0.00011270533286733553 Final Loss: 0.0001228590408572927
Step 6200 Loss: 0.0001076938133337535 Final Loss: 0.00011414685286581516
Step 6300 Loss: 0.00011062520934501663 Final Loss: 0.00011898639058927074
Step 6400 Loss: 0.00010303657472832128 Final Loss: 0.00010417139128549024
Step 6500 Loss: 0.00010071651922771707 Final Loss: 0.00011659633310046047
Step 6600 Loss: 9.24945343285799e-05 Final Loss: 0.00010580563684925437
Step 6700 Loss: 8.040041575441137e-05 Final Loss: 8.220678864745423e-05
Step 6800 Loss: 8.52714292705059e-05 Final Loss: 8.551881182938814e-05
Step 6900 Loss: 7.363418262684718e-05 Final Loss: 8.367044938495383e-05
Step 7000 Loss: 7.770038791932166e-05 Final Loss: 8.169656211975962e-05
Step 7100 Loss: 6.621181091759354e-05 Final Loss: 6.812172796344385e-05
Step 7200 Loss: 6.263991963351145e-05 Final Loss: 7.151816680561751e-05
Step 7300 Loss: 6.431694055208936e-05 Final Loss: 8.336145401699468e-05
Step 7400 Loss: 6.217251939233392e-05 Final Loss: 7.42587581044063e-05
Step 7500 Loss: 5.803887324873358e-05 Final Loss: 5.64903202757705e-05
Step 7600 Loss: 5.8021680160891265e-05 Final Loss: 7.114167237887159e-05
Step 7700 Loss: 4.7135476052062586e-05 Final Loss: 5.790746217826381e-05
Step 7800 Loss: 4.5154723920859396e-05 Final Loss: 5.2449991926550865e-05
Step 7900 Loss: 5.171455632080324e-05 Final Loss: 5.62660934519954e-05
Step 8000 Loss: 4.494317909120582e-05 Final Loss: 4.730399086838588e-05
Step 8100 Loss: 4.028403418487869e-05 Final Loss: 4.883216752205044e-05
Step 8200 Loss: 4.035784877487458e-05 Final Loss: 4.770160376210697e-05
Step 8300 Loss: 3.888394348905422e-05 Final Loss: 4.441792407305911e-05
Step 8400 Loss: 3.9365306292893365e-05 Final Loss: 4.54806286143139e-05
Step 8500 Loss: 3.3779571822378784e-05 Final Loss: 4.9338981625624e-05
Step 8600 Loss: 3.4127882827306166e-05 Final Loss: 4.301142689655535e-05
Step 8700 Loss: 3.0475057428702712e-05 Final Loss: 3.980950350523926e-05
Traceback (most recent call last):
  File "/accounts/projects/peter/gatmiry/distributional-CoT/train.py", line 51, in <module>
    main()
    ~~~~^^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
    ~~~~~~~~~~^
        args=args,
        ^^^^^^^^^^
    ...<3 lines>...
        config_name=config_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
    ~~~~~~~~^
        run=args.run,
        ^^^^^^^^^^^^^
    ...<5 lines>...
        overrides=overrides,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
    ~~~~~~~~~~~~~~^
        lambda: hydra.run(
        ^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        )
        ^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ~~~~~~~~~^
        config_name=config_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^
        task_function=task_function,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        overrides=overrides,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
        hydra_context=HydraContext(
    ...<6 lines>...
        configure_logging=with_log_configuration,
    )
  File "/accounts/projects/peter/gatmiry/.local/lib/python3.13/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ~~~~~~~~~~~~~^^^^^^^^^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/train.py", line 47, in main
    train.fit()
    ~~~~~~~~~^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py", line 59, in fit
    batch, cot_outputs = dataset.get_batch(batch_size=batch_size, flipping_subsets=flipping_subsets)
                         ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py", line 205, in get_batch
    result = self.target_function(cot_tmp_batch_flipping)
  File "/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py", line 166, in compute_function
    target_vals = target_vals + coeff * term_vals
    ^^^^^^^^^^^
KeyboardInterrupt
