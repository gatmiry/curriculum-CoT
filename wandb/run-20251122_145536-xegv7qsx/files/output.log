================================================================================
Using device: cuda
/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py:69: UserWarning: Using a target size (torch.Size([128])) that is different to the input size (torch.Size([127, 48, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  final_loss = F.mse_loss(output_vals[:-1], cot_outputs[:, -1])
Step 0 Loss: 1.8848152160644531 Final Loss: 1.0818736553192139
Step 100 Loss: 0.673333466053009 Final Loss: 1.110982060432434
Step 200 Loss: 0.12311845272779465 Final Loss: 1.7298897504806519
Step 300 Loss: 0.10756322741508484 Final Loss: 1.8424599170684814
Step 400 Loss: 0.0775691568851471 Final Loss: 1.914259910583496
Step 500 Loss: 0.0671825036406517 Final Loss: 1.9076977968215942
Step 600 Loss: 0.06224396452307701 Final Loss: 1.8741720914840698
Step 700 Loss: 0.05354313924908638 Final Loss: 1.8703680038452148
Step 800 Loss: 0.041996393352746964 Final Loss: 2.194410800933838
Step 900 Loss: 0.011204580776393414 Final Loss: 2.2319982051849365
Step 1000 Loss: 0.0033623548224568367 Final Loss: 2.125908851623535
Step 1100 Loss: 0.0017291646217927337 Final Loss: 2.055110454559326
Step 1200 Loss: 0.0014084991998970509 Final Loss: 1.9913485050201416
Step 1300 Loss: 0.0010162797989323735 Final Loss: 2.097186803817749
Step 1400 Loss: 0.0008455550414510071 Final Loss: 1.9258922338485718
Step 1500 Loss: 0.0005652303225360811 Final Loss: 2.119943380355835
Step 1600 Loss: 0.0004812591359950602 Final Loss: 2.004187822341919
Step 1700 Loss: 0.0004753257380798459 Final Loss: 2.131700038909912
Step 1800 Loss: 0.00030473273363895714 Final Loss: 1.9584112167358398
Step 1900 Loss: 0.0002617187856230885 Final Loss: 2.154242753982544
Step 2000 Loss: 0.000314411852741614 Final Loss: 2.060918092727661
Step 2100 Loss: 0.0001934242172865197 Final Loss: 1.9348852634429932
Step 2200 Loss: 0.0002164958423236385 Final Loss: 2.0896716117858887
Step 2300 Loss: 0.00022603521938435733 Final Loss: 1.9326038360595703
Step 2400 Loss: 0.0001745344343362376 Final Loss: 1.9972580671310425
Step 2500 Loss: 0.00016904000949580222 Final Loss: 2.0028223991394043
Step 2600 Loss: 0.00018491757509764284 Final Loss: 1.8022172451019287
Step 2700 Loss: 0.0001291268563363701 Final Loss: 1.8783074617385864
Step 2800 Loss: 0.0001347655343124643 Final Loss: 1.9083251953125
Step 2900 Loss: 0.00011610695219133049 Final Loss: 2.178436517715454
Step 3000 Loss: 0.0002979981654789299 Final Loss: 1.9038854837417603
Step 3100 Loss: 0.0004114556359127164 Final Loss: 1.9150372743606567
Step 3200 Loss: 0.00025963730877265334 Final Loss: 1.9018831253051758
Step 3300 Loss: 0.0001950674777617678 Final Loss: 2.0192766189575195
Step 3400 Loss: 8.547868492314592e-05 Final Loss: 1.953339695930481
Step 3500 Loss: 0.00017472042236477137 Final Loss: 2.059535503387451
Step 3600 Loss: 6.850277713965625e-05 Final Loss: 1.843579649925232
Step 3700 Loss: 0.00017246844072360545 Final Loss: 2.005074977874756
Step 3800 Loss: 6.348905299091712e-05 Final Loss: 1.8422183990478516
Step 3900 Loss: 8.37832412798889e-05 Final Loss: 2.0111324787139893
Step 4000 Loss: 0.00033623198396526277 Final Loss: 2.0737149715423584
Step 4100 Loss: 5.526292443391867e-05 Final Loss: 1.9847458600997925
Step 4200 Loss: 5.783729284303263e-05 Final Loss: 2.117149829864502
Step 4300 Loss: 0.00016236823284998536 Final Loss: 1.9825550317764282
Step 4400 Loss: 8.128423360176384e-05 Final Loss: 2.0174291133880615
Step 4500 Loss: 0.0014416405465453863 Final Loss: 1.9218811988830566
Step 4600 Loss: 3.831375215668231e-05 Final Loss: 2.061789035797119
Step 4700 Loss: 9.400620183441788e-05 Final Loss: 2.1682491302490234
Step 4800 Loss: 3.47464119840879e-05 Final Loss: 1.832098364830017
Step 4900 Loss: 5.228481313679367e-05 Final Loss: 1.9625980854034424
Step 5000 Loss: 2.87537641270319e-05 Final Loss: 1.8354393243789673
Step 5100 Loss: 5.344107557903044e-05 Final Loss: 1.9903384447097778
Step 5200 Loss: 2.6038067517220043e-05 Final Loss: 2.032318115234375
Step 5300 Loss: 4.025050293421373e-05 Final Loss: 1.9496475458145142
Step 5400 Loss: 4.349048685980961e-05 Final Loss: 2.0839760303497314
Step 5500 Loss: 2.5839768568403088e-05 Final Loss: 1.9176414012908936
Step 5600 Loss: 3.136323357466608e-05 Final Loss: 1.9352144002914429
Step 5700 Loss: 4.7888246626826e-05 Final Loss: 2.1348540782928467
Step 5800 Loss: 4.4514064938994125e-05 Final Loss: 1.9982141256332397
Step 5900 Loss: 8.788761624600738e-05 Final Loss: 1.9333090782165527
Step 6000 Loss: 3.517358345561661e-05 Final Loss: 2.0103347301483154
Step 6100 Loss: 0.00017269411182496697 Final Loss: 1.975898027420044
Step 6200 Loss: 3.762661435757764e-05 Final Loss: 1.8592039346694946
Step 6300 Loss: 5.345540921553038e-05 Final Loss: 1.7973086833953857
Step 6400 Loss: 3.832003858406097e-05 Final Loss: 1.996908187866211
Step 6500 Loss: 2.3865302864578553e-05 Final Loss: 1.9033491611480713
Step 6600 Loss: 3.624632518040016e-05 Final Loss: 2.0888354778289795
Step 6700 Loss: 2.008230694627855e-05 Final Loss: 1.8412915468215942
Step 6800 Loss: 3.755974830710329e-05 Final Loss: 2.0473647117614746
Step 6900 Loss: 1.868685103545431e-05 Final Loss: 1.894940972328186
Step 7000 Loss: 3.091668986598961e-05 Final Loss: 1.9765706062316895
Step 7100 Loss: 0.0009056837880052626 Final Loss: 1.9192129373550415
Step 7200 Loss: 0.0002899832325056195 Final Loss: 1.832367181777954
Step 7300 Loss: 0.0001664577575866133 Final Loss: 1.984155535697937
Step 7400 Loss: 0.00012697026249952614 Final Loss: 1.705589771270752
Step 7500 Loss: 8.751398854656145e-05 Final Loss: 2.0367238521575928
Step 7600 Loss: 7.71663908381015e-05 Final Loss: 1.8903427124023438
Step 7700 Loss: 6.080351522541605e-05 Final Loss: 2.061291217803955
Step 7800 Loss: 5.261404294287786e-05 Final Loss: 1.999350666999817
Step 7900 Loss: 4.708618871518411e-05 Final Loss: 2.021967649459839
Step 8000 Loss: 3.8548503653146327e-05 Final Loss: 1.8784626722335815
Step 8100 Loss: 3.8247428165050223e-05 Final Loss: 1.9184329509735107
Step 8200 Loss: 3.048923463211395e-05 Final Loss: 1.8737107515335083
Step 8300 Loss: 2.6225101464660838e-05 Final Loss: 1.9626175165176392
Step 8400 Loss: 2.4530350856366567e-05 Final Loss: 1.986030101776123
Step 8500 Loss: 2.2769463612348773e-05 Final Loss: 1.9221893548965454
Step 8600 Loss: 2.217190012743231e-05 Final Loss: 2.1338391304016113
Step 8700 Loss: 2.118644624715671e-05 Final Loss: 1.7344579696655273
Step 8800 Loss: 1.8787839508149773e-05 Final Loss: 1.9205840826034546
Step 8900 Loss: 1.779167359927669e-05 Final Loss: 1.839579463005066
Step 9000 Loss: 1.630009319342207e-05 Final Loss: 2.0557701587677
Step 9100 Loss: 1.5263080058502965e-05 Final Loss: 1.8215391635894775
Step 9200 Loss: 1.4637000276707113e-05 Final Loss: 1.8558001518249512
Step 9300 Loss: 1.4163540981826372e-05 Final Loss: 1.9756807088851929
Step 9400 Loss: 1.3936969480710104e-05 Final Loss: 1.8167684078216553
Step 9500 Loss: 1.2604773473867681e-05 Final Loss: 2.0641188621520996
Step 9600 Loss: 1.045383578457404e-05 Final Loss: 1.9339981079101562
Step 9700 Loss: 1.098464781534858e-05 Final Loss: 1.8522298336029053
Step 9800 Loss: 1.002316548692761e-05 Final Loss: 2.1014373302459717
Step 9900 Loss: 1.005078502203105e-05 Final Loss: 2.0711605548858643
