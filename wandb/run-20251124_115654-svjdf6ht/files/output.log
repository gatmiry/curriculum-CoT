step is  0  cot_outputs shape is  torch.Size([1, 8])
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 8])
Step 0 Loss: 0.9916300773620605 Final Loss: 0.9191470742225647
Test input: tensor([1, 1, 1, 1, 1, 1, 0, 1], device='cuda:0')
shape of self.transformer.wte(idx) torch.Size([64])  shape of cts_tokens torch.Size([1, 1, 64])
Error executing job with overrides: []
Traceback (most recent call last):
  File "/accounts/projects/peter/gatmiry/distributional-CoT/train.py", line 47, in main
    train.fit()
    ~~~~~~~~~^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/test_composite_function.py", line 103, in fit
    test_output = model.generate(test_input)
  File "/accounts/projects/peter/gatmiry/distributional-CoT/model.py", line 115, in generate
    output_vals, _ = self.forward(idx, torch.cat([cot_tokens, torch.zeros(B, 1, self.config.n_embd, device=idx.device)], dim=1))
                     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/projects/peter/gatmiry/distributional-CoT/model.py", line 102, in forward
    x = pe_vecs + torch.cat([self.transformer.wte(idx), cts_tokens.unsqueeze(2) @ self.transformer.wte(self.const_dir_idx).unsqueeze(0).unsqueeze(0)], dim=1)
                                                        ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
RuntimeError: Expected size for first two dimensions of batch2 tensor to be: [1, 64] but got: [1, 1].

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
